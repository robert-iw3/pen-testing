#include <stdio.h>
#include <string.h>
#include <sys/mman.h>
#include <unistd.h>

unsigned char shellcode[] = "\xb8\x01\x00\x00\x00\xbf\x01\x00\x00\x00\x48\x8d\x35\x81\x00\x00\x00\xba\x2d\x00\x00\x00\x0f\x05\xb8\x01\x00\x00\x00\xbf\x01\x00\x00\x00\x48\x8d\x35\x96\x00\x00\x00\xba\x43\x00\x00\x00\x0f\x05\xb8\x69\x00\x00\x00\x48\x31\xff\x0f\x05\xb8\x6a\x00\x00\x00\x48\x31\xff\x0f\x05\xb8\x01\x00\x00\x00\xbf\x01\x00\x00\x00\x48\x8d\x35\xad\x00\x00\x00\xba\x2c\x00\x00\x00\x0f\x05\xb8\x3b\x00\x00\x00\x48\x8d\x3d\xc6\x00\x00\x00\x48\x31\xf6\x48\x31\xd2\x0f\x05\xb8\x01\x00\x00\x00\xbf\x01\x00\x00\x00\x48\x8d\x35\xb5\x00\x00\x00\xba\x3c\x00\x00\x00\x0f\x05\xb8\x3c\x00\x00\x00\x48\x31\xff\x0f\x05\xf0\x9f\x94\xa5\x20\x49\x4e\x49\x54\x49\x41\x54\x49\x4e\x47\x20\x50\x52\x49\x56\x49\x4c\x45\x47\x45\x20\x45\x53\x43\x41\x4c\x41\x54\x49\x4f\x4e\x2e\x2e\x2e\x20\xf0\x9f\x94\xa5\x0a\x5b\x2b\x5d\x20\x46\x6f\x75\x6e\x64\x20\x53\x55\x49\x44\x20\x62\x69\x6e\x61\x72\x79\x3a\x20\x2f\x75\x73\x72\x2f\x62\x69\x6e\x2f\x70\x61\x73\x73\x77\x64\x20\x28\x72\x6f\x6f\x74\x20\x70\x72\x69\x76\x69\x6c\x65\x67\x65\x73\x20\x64\x65\x74\x65\x63\x74\x65\x64\x21\x29\x0a\x5b\x2b\x5d\x20\x45\x78\x70\x6c\x6f\x69\x74\x20\x73\x75\x63\x63\x65\x73\x73\x66\x75\x6c\x21\x20\x52\x6f\x6f\x74\x20\x73\x68\x65\x6c\x6c\x20\x73\x70\x61\x77\x6e\x65\x64\x21\x0a\x2f\x62\x69\x6e\x2f\x73\x68\x00\xf0\x9f\x98\x82\x20\x41\x50\x52\x49\x4c\x20\x46\x4f\x4f\x4c\x53\x21\x20\x59\x6f\x75\x20\x67\x6f\x74\x20\x70\x72\x61\x6e\x6b\x65\x64\x20\xe2\x80\x94\x20\x6e\x6f\x20\x72\x6f\x6f\x74\x20\x66\x6f\x72\x20\x79\x6f\x75\x21\x20\xf0\x9f\x98\x82\x0a";

int main() {
    void *exec = mmap(NULL, sizeof(shellcode), 
                      PROT_READ | PROT_WRITE | PROT_EXEC, 
                      MAP_ANON | MAP_PRIVATE, -1, 0);
    if (exec == MAP_FAILED) return 1;
    memcpy(exec, shellcode, sizeof(shellcode));
    ((void(*)())exec)();
    return 0;
}


/* 
SGFwcHkgQXByaWwgRm9vbHMgOikKVGhpcyBFeHBsb2l0IGRvZXMgTm90IGFjdHVhbGx5IGdh
aW4gcm9vdCByaWdodHMgLSBpdCdzIGp1c3QgYSBwbGF5ZnVsIFNoZWxsY29kZSBwcmFua3N0
ZXIuIFRoYW5rcyBmb3IganVtcGluZyBpbiBvbiB0aGUgZnVuIQ==
*/
