#!/bin/bash

TARGET=""
BASE_PATH="/visual_composer"
APP_NAME="cache.jsp"

COMMON_PATHS=(
    "$BASE_PATH/$APP_NAME/"
    "$BASE_PATH/$APP_NAME/shell.jsp"
    "$BASE_PATH/$APP_NAME/pages/shell.jsp"
    "$BASE_PATH/$APP_NAME/htmlb/shell.jsp"
    "$BASE_PATH/uploads/$APP_NAME/shell.jsp"
    "$BASE_PATH/resources/$APP_NAME/shell.jsp"
    "$BASE_PATH/$APP_NAME/WEB-INF/shell.jsp"
    "$BASE_PATH/$APP_NAME/META-INF/shell.jsp"
    "$BASE_PATH/$APP_NAME/shell.jspx"
)

echo "[*] Starting brute scan against $TARGET..."

for path in "${COMMON_PATHS[@]}"; do
    echo -n "[*] Checking $path ... "
    response=$(curl -sk -o /dev/null -w "%{http_code}" "$TARGET$path")
    
    if [[ "$response" == "200" ]]; then
        echo "FOUND (HTTP 200 OK)"
    elif [[ "$response" == "403" ]]; then
        echo "FORBIDDEN (HTTP 403)"
    elif [[ "$response" == "401" ]]; then
        echo "UNAUTHORIZED (HTTP 401)"
    else
        echo "NOT FOUND (HTTP $response)"
    fi
done
