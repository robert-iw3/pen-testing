#!/usr/bin/env python
# coding:utf-8
import my_rdp
import sys
import json

def sodok(ip, port):
    """

    """
    if not ip or not port:
        print("Error: IP and Port must be provided.")
        return

    try:
        ret = my_rdp.rdp_check(ip, int(port), timeout=5, isscreen=False)
        if ret:
            print(json.dumps(ret, indent=4))
        else:
            print(f"No RDP information could be retrieved from {ip}:{port} or target cannot be reached.")

    except Exception as e:
        print(f"An error occurred while checking {ip}:{port}: {e}")

if __name__ == '__main__':
    if len(sys.argv) != 3:
        print("Usage: python3 sodok.py <TARGET_IP> <TARGET_PORT>")
        sys.exit(1)

    target_ip = sys.argv[1]
    target_port = sys.argv[2]

    sodok(target_ip, target_port)
