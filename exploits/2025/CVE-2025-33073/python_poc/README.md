# CVE-2025-33073
PoC Exploit for the NTLM reflection SMB flaw.

### Prerequisites
OS: Kali Linux (has most packages pre-installed).

* Netexec (NXC) - https://github.com/Pennyw0rth/NetExec
* impacket-ntlmrelayx
* dnstool.py (included in repo)
* xterm

### Example usage

```
python3 CVE-2025-33073.py -u 'wintastic.local\mathijs' -p 'password' --attacker-ip 192.168.178.49 --dns-ip 192.168.178.138 --dc-fqdn DC01.wintastic.local --target CLIENT01.wintastic.local --target-ip 192.168.178.65
```
![image](https://github.com/user-attachments/assets/83ce744a-161e-4c0f-9f2d-6d57f23a913c)

#### Good to know
* xterm allows copying and pasting with the middle mouse button.

Some more information about the coercion that is being used:

| OS / Version                             | PetitPotam | Notes                                                                                      |
|------------------------------------------|-----------------------|--------------------------------------------------------------------------------------------|
| **Windows 11 (22H2, 23H2, 24H2)**         | ❌ No                  | Mitigated by default; MS-EFSRPC hardened and NTLM use restricted.                         |
| **Windows Server 2025 (Preview)**         | ❌ No                  | Latest builds have coercion blocked by default.                                           |
| **Windows Server 2022**                  | ❌ No                  | Patched before release; MS-EFSRPC mitigated by default.                                   |
| **Windows Server 2019**                  | ✅ Yes                 | Still works unless fully patched and NTLM restrictions configured.                        |
| **Windows Server 2016**                  | ✅ Yes                 | MS-EFSRPC interface still usable; NTLM allowed by default.                                |
| **Windows Server 2012 R2**               | ✅ Yes                 | Coercion works out of the box; needs manual hardening.                                    |
| **Windows Server 2008 R2**               | ✅ Yes                 | Fully vulnerable if unpatched; no default mitigations in place.                           |
| **Windows 10 (up to 21H2)**              | ✅ Yes                 | Vulnerable unless patched; EFSRPC coercion works if NTLM is enabled.                      |

#### How to fix
https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2025-33073
