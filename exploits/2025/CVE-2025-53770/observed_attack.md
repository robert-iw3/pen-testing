### Vulnerability analysis
---

SharePoint’s ToolPane.aspx is a component responsible for assembling the UI side panel view. The exploitation of the vulnerability consists of two steps:

1) Attackers can first perform an authentication bypass
2) This bypass then allows them to exploit the second insecure deserialization vulnerability, leading to code execution on the server

### Step 1: Exploiting the authentication bypass (CVE-2025-49706)
---

The first step in exploiting CVE-2025-49706 is to send a specially crafted POST request to the endpoint, manipulating the `HTTP 'Referer' header`.  The attacker targets the endpoint value `/_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx` with the crafted value `/_layouts/SignOut.aspx` to manipulate the system into trusting the request and its payload.


### Step 2: Exploiting the deserialization vulnerability (CVE-2025-49704)
---

Once the authentication bypass is achieved, attackers can exploit the deserialization vulnerability to execute PowerShell code. In observed attacks, attackers deployed a malicious second-stage ASPX file designed to extract cryptographic keys that are signed (`MachineKey`) from `web.config` (which the server trusts), enabling stealthier follow-up exploitation (Figure 1).

<p align="center">
  <img src=".img/figure1.jpeg" />
</p>
</sup>Fig. 1: Malicious ASPX file to exploit CVE-2025-49704</sub>


This is a stealthy approach for a few reasons:

    The payloads appear legitimate to the application — they pass signature validation, so no alarms are triggered by viewstate tampering checks.

    The malicious code is executed within the normal SharePoint process (w3wp.exe), which blends in with legitimate activity.

    There’s no need to drop additional files or re-exploit authentication, reducing the forensic footprint.

This technique allows attackers to maintain access or escalate impact while avoiding many traditional detection mechanisms.

### Remote code execution
---

By accessing the deployed malicious endpoint, attackers can extract the cryptographic secrets needed to sign serialized payloads (Figure 2).

<p align="center">
  <img src=".img/figure2.jpeg" />
</p>
</sup>Fig. 2: Example of the MachineKey value</sub>


The cryptographic information is then used to create a serialized C# code in a valid `__VIEWSTATE` payload based on the `TypeConfuseDelegate` gadget generator — a tool used to create an exploitable sequence of code that can be abused for deserialization attacks (Figure 3).

<p align="center">
  <img src=".img/figure3.jpeg" />
</p>
</sup>Fig. 3: Retrieving the __VIEWSTATEGENERATOR for malicious __VIEWSTATE payload signing</sub>


From that point, detecting malicious activity becomes significantly harder, as the payload executes within the legitimate w3wp.exe process.
Exploitation details

Multiple public proof-of-concept (PoC) exploits for CVE-2025-53770 have recently been seen on GitHub and other platforms. Threat actors are actively leveraging these PoCs to compromise unpatched SharePoint systems.

We observed active exploitation attempts targeting the SharePoint endpoint `/_layouts/15/ToolPane.aspx` across multiple hostnames, originating from various IP addresses (Figure 4).

<p align="center">
  <img src=".img/figure4.jpeg" />
</p>
</sup>Fig. 4: Sample scanning activity for /_layouts/15/ToolPane.aspx POST requests</sub>


Analysis of customer traffic showed DNS connections to one of the IPs associated with the campaign 96.9.125[.]147, which resolved to dynastyjusticecollective[.]site. This was independently mentioned by researcher @raffaele_forte, which supports our assumption that it’s malicious activity rather than benign scanning.

### Indicators of compromise
---

    107.191.58[.]76

    104.238.159[.]149

    96.9.125[.]147

    dynastyjusticecollective[.]site

