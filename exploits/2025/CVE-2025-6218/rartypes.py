from __future__ import annotations
from enum import Flag
from utils.bytes import FlagBytePackingMixin
    

class GeneralExtraAreaType(FlagBytePackingMixin, Flag):
    LOCATOR=0x01
    METADATA=0x02

class ExtraAreaType(FlagBytePackingMixin, Flag):
    FILE_ENCRYPTION=0x01
    FILE_HASH=0x02
    TIME=0x03
    FILE_VERSION=0x04
    FILE_REDIRECTION=0x05
    UNIX_OWNER=0x06
    SERVICE=0x07

class BlockType(FlagBytePackingMixin, Flag):
    NONE=0x00
    MAIN=0x01
    FILE=0x02
    SERVICE=0x03
    ENCRYPTION=0x04
    ARCHIVE_END=0x05

class BlockFlags(FlagBytePackingMixin, Flag):
    NONE=0x00
    HAS_EXTRA=0x01
    HAS_DATA=0x02
    UNKNOWN_TYPE=0x04
    DATA_IS_FROM_PREV=0x08
    DATA_CONTINUES_ON_NEXT=0x10
    BLOCK_DEPENDS_ON_PREV=0x20
    PRESERVE_CHILD=0x40

class FileFlags(FlagBytePackingMixin, Flag):
    NONE=0x00
    DIRECTORY=0x01
    UNIX_TIME=0x02
    CRC_PRESENT=0x04
    UNPACKED_SIZE_UNKNOWN=0x08

class FileAttributes(FlagBytePackingMixin, Flag):
    NONE=0x00
    READ_ONLY=0x01
    HIDDEN=0x02
    SYSTEM=0x04
    DIRECTORY=0x10
    ARCHIVE=0x20
    DEVICE=0x40
    NORMAL=0x80
    TEMPORARY=0x100
    SPARSE_FILE=0x200
    REPARSE_POINT=0x400
    COMPRESSED=0x800
    OFFLINE=0x1000
    NOT_CONTENT_INDEXED=0x2000
    ENCRYPTED=0x4000
    INTEGRITY_STREAM=0x8000
    VIRTUAL=0x10000
    NO_SCRUB_DATA=0x20000
    EXTENDED_ATTRIBUTES=0x40000
    PINNED=0x80000
    UNPINNED=0x100000
    RECALL_ON_OPEN=0x40000
    RECALL_ON_DATA_ACCESS=0x400000

class CompressionMethod(FlagBytePackingMixin, Flag):
    SOLID=0x40

class HostOS(FlagBytePackingMixin, Flag):
    WINDOWS=0x00
    UNIX=0x01