// ExploitServlet.java (for Tomcat 10 / Jakarta)
import java.io.*;
import jakarta.servlet.*;
import jakarta.servlet.http.*;

public class ExploitServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        ObjectInputStream ois = new ObjectInputStream(request.getInputStream());
        try {
            Object obj = ois.readObject();
            response.getWriter().println("Deserialized: " + obj.toString());
        } catch (ClassNotFoundException e) {
            e.printStackTrace(response.getWriter());
        }
    }
}

