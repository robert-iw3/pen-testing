# OpenSSH CVE-2024-6387 Exploit

This repository contains a Python script designed to exploit the remote code execution (RCE) vulnerability in OpenSSH (CVE-2024-6387). This vulnerability involves a signal handler race condition that can lead to arbitrary code execution, allowing attackers to gain root access. This proof-of-concept is intended for educational purposes only.

## Overview

OpenSSH's CVE-2024-6387 is a critical vulnerability caused by a regression of a previously fixed issue. It involves a race condition in the signal handler that can be exploited to execute arbitrary code as root.

## Features

- **Multithreading**: Increases the chances of winning the race condition.
- **Success Event**: Stops attempts once the exploit succeeds.
- **Timing Adjustments**: Fine-tunes the timing required to trigger the race condition.
- **IPv4 and IPv6 Support**: Handles both IPv4 and IPv6 addresses for broader compatibility. [oferchen](https://github.com/oferchen)
- **Command-Line Arguments**: Allows flexible configuration of target IP, port, maximum attempts, number of threads, and glibc base address. [oferchen](https://github.com/oferchen)

## Usage

### Prerequisites

- Python 3.x

### Running the Exploit

 **Execute the script**:

    ```sh
    python exploit_cve_2024_6387.py <target_ip> <target_port> --max_attempts 10000 --num_threads 10 --glibc_base 0xb7400000
    ```

    Example:
    ```sh
    python exploit_cve_2024_6387.py 192.168.1.100 22 --max_attempts 10000 --num_threads 10 --glibc_base 0xb7400000
    ```
