#pragma once

#include<Windows.h>
#include <winternl.h>

/*
-------------------------------------------------------------------------------------------------------
Macro definitions
*/
#define ADD_OFFSET_TO_POINTER(POINTER, OFFSET) (PBYTE)POINTER + OFFSET
#define OBJECT_NAME_INFORMATION_CLASS 1

/*
-------------------------------------------------------------------------------------------------------
Types for NT functions
*/
typedef NTSTATUS NTQuerySystemInformation(
	SYSTEM_INFORMATION_CLASS SystemInformationClass,
	PVOID SystemInformation,
	ULONG SystemInformationLength,
	PULONG ReturnLength);

typedef __kernel_entry NTSYSCALLAPI NTSTATUS NTQueryObject(
	IN  HANDLE Handle,
	IN  OBJECT_INFORMATION_CLASS ObjectInformationClass,
	OUT PVOID ObjectInformation,
	IN ULONG ObjectInformationLength,
    OUT PULONG ReturnLength
);

/*
-------------------------------------------------------------------------------------------------------
Structs
*/
typedef struct _WINFUNC {
	NTQuerySystemInformation* pNTQuerySystemInformation;
	NTQueryObject* pNTQueryObject;
} WINFUNC, *PWINFUNC;

typedef struct _OBJECT_NAME_INFORMATION {
	UNICODE_STRING Name;
} OBJECT_NAME_INFORMATION, *POBJECT_NAME_INFORMATION;

/*
-------------------------------------------------------------------------------------------------------
Functions
*/
DWORD StringLenW(PWCHAR pStr);
bool StringCompareA(PCHAR pStr1, PCHAR pStr2);
bool StringCompareW(PWCHAR pStr1, PWCHAR pStr2);
void StringLowerW(PWCHAR pStrIn, PWCHAR pStrOut);
void RtlZeroMemoryCustom(LPVOID pBuf, DWORD bufSize);
void CopyBuffer(PBYTE pDestination, PBYTE pSource, DWORD howMuchToCopy);
void Utf8ToUtf16String(IN PCHAR strIn, OUT PWCHAR strOut);