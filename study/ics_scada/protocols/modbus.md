# Modbus

| Protocol | Modbus |
|---|---|
| Name | Modbus |
| Aliases | Modbus TCP |
| Description | Widely used industrial communication protocol |
| Port(s) | 502/tcp |
| Specifications | [Modbus TCP Specification](https://modbus.org/specs.php) |
| Nmap script(s) | [modbus-discover.nse](https://nmap.org/nsedoc/scripts/modbus-discover.html), [modicon-info.nse](https://github.com/digitalbond/Redpoint/blob/master/modicon-info.nse) |
| Wireshark dissector | [packet-mbtcp.c](https://github.com/wireshark/wireshark/blob/master/epan/dissectors/packet-mbtcp.c) |
| Scapy layer | [modbus.py](https://github.com/secdev/scapy/blob/master/scapy/contrib/modbus.py) |
| Example Pcap(s) | [ICS-pcap Modbus](https://github.com/automayt/ICS-pcap/tree/master/MODBUS), [S4x15 ICS Village PCAP Files](https://www.netresec.com/?page=DigitalBond_S4) |
| Related CVE | [CVE-2007-4827](https://nvd.nist.gov/vuln/detail/CVE-2007-4827), [CVE-2010-4709](https://nvd.nist.gov/vuln/detail/CVE-2010-4709), [CVE-2011-4861](https://nvd.nist.gov/vuln/detail/CVE-2011-4861), [CVE-2013-0662](https://nvd.nist.gov/vuln/detail/CVE-2013-0662), [CVE-2013-2784](https://nvd.nist.gov/vuln/detail/CVE-2013-2784), [CVE-2013-5741](https://nvd.nist.gov/vuln/detail/CVE-2013-5741), [CVE-2014-0777](https://nvd.nist.gov/vuln/detail/CVE-2014-0777), [CVE-2017-11401](https://nvd.nist.gov/vuln/detail/CVE-2017-11401), [CVE-2017-14462](https://nvd.nist.gov/vuln/detail/CVE-2017-14462), [CVE-2017-6032](https://nvd.nist.gov/vuln/detail/CVE-2017-6032), [CVE-2017-6034](https://nvd.nist.gov/vuln/detail/CVE-2017-6034), [CVE-2017-7575](https://nvd.nist.gov/vuln/detail/CVE-2017-7575), [CVE-2018-5400](https://nvd.nist.gov/vuln/detail/CVE-2018-5400), [CVE-2018-5401](https://nvd.nist.gov/vuln/detail/CVE-2018-5401), [CVE-2018-7794](https://nvd.nist.gov/vuln/detail/CVE-2018-7794), [CVE-2018-7842](https://nvd.nist.gov/vuln/detail/CVE-2018-7842), [CVE-2018-7843](https://nvd.nist.gov/vuln/detail/CVE-2018-7843), [CVE-2018-7844](https://nvd.nist.gov/vuln/detail/CVE-2018-7844), [CVE-2018-7845](https://nvd.nist.gov/vuln/detail/CVE-2018-7845), [CVE-2018-7846](https://nvd.nist.gov/vuln/detail/CVE-2018-7846), [CVE-2018-7847](https://nvd.nist.gov/vuln/detail/CVE-2018-7847), [CVE-2018-7848](https://nvd.nist.gov/vuln/detail/CVE-2018-7848), [CVE-2018-7849](https://nvd.nist.gov/vuln/detail/CVE-2018-7849), [CVE-2018-7851](https://nvd.nist.gov/vuln/detail/CVE-2018-7851), [CVE-2018-7852](https://nvd.nist.gov/vuln/detail/CVE-2018-7852), [CVE-2018-7853](https://nvd.nist.gov/vuln/detail/CVE-2018-7853), [CVE-2018-7854](https://nvd.nist.gov/vuln/detail/CVE-2018-7854), [CVE-2018-7855](https://nvd.nist.gov/vuln/detail/CVE-2018-7855), [CVE-2018-7856](https://nvd.nist.gov/vuln/detail/CVE-2018-7856), [CVE-2018-7857](https://nvd.nist.gov/vuln/detail/CVE-2018-7857), [CVE-2019-6806](https://nvd.nist.gov/vuln/detail/CVE-2019-6806), [CVE-2019-6807](https://nvd.nist.gov/vuln/detail/CVE-2019-6807), [CVE-2019-6808](https://nvd.nist.gov/vuln/detail/CVE-2019-6808), [CVE-2019-6816](https://nvd.nist.gov/vuln/detail/CVE-2019-6816), [CVE-2019-6819](https://nvd.nist.gov/vuln/detail/CVE-2019-6819), [CVE-2019-6828](https://nvd.nist.gov/vuln/detail/CVE-2019-6828), [CVE-2019-6829](https://nvd.nist.gov/vuln/detail/CVE-2019-6829), [CVE-2019-6845](https://nvd.nist.gov/vuln/detail/CVE-2019-6845), [CVE-2019-6856](https://nvd.nist.gov/vuln/detail/CVE-2019-6856), [CVE-2019-6857](https://nvd.nist.gov/vuln/detail/CVE-2019-6857), [CVE-2020-28212](https://nvd.nist.gov/vuln/detail/CVE-2020-28212), [CVE-2020-28213](https://nvd.nist.gov/vuln/detail/CVE-2020-28213), [CVE-2020-6970](https://nvd.nist.gov/vuln/detail/CVE-2020-6970), [CVE-2020-7477](https://nvd.nist.gov/vuln/detail/CVE-2020-7477), [CVE-2020-7537](https://nvd.nist.gov/vuln/detail/CVE-2020-7537), [CVE-2020-7538](https://nvd.nist.gov/vuln/detail/CVE-2020-7538), [CVE-2020-7542](https://nvd.nist.gov/vuln/detail/CVE-2020-7542), [CVE-2020-7543](https://nvd.nist.gov/vuln/detail/CVE-2020-7543), [CVE-2020-7559](https://nvd.nist.gov/vuln/detail/CVE-2020-7559), [CVE-2021-20589](https://nvd.nist.gov/vuln/detail/CVE-2021-20589), [CVE-2021-20592](https://nvd.nist.gov/vuln/detail/CVE-2021-20592), [CVE-2021-21002](https://nvd.nist.gov/vuln/detail/CVE-2021-21002), [CVE-2021-21964](https://nvd.nist.gov/vuln/detail/CVE-2021-21964), [CVE-2020-5675](https://nvd.nist.gov/vuln/detail/CVE-2020-5675), [CVE-2021-22642](https://nvd.nist.gov/vuln/detail/CVE-2021-22642), [CVE-2021-22648](https://nvd.nist.gov/vuln/detail/CVE-2021-22648), [CVE-2021-22659](https://nvd.nist.gov/vuln/detail/CVE-2021-22659), [CVE-2021-22779](https://nvd.nist.gov/vuln/detail/CVE-2021-22779), [CVE-2021-22786](https://nvd.nist.gov/vuln/detail/CVE-2021-22786), [CVE-2021-22816](https://nvd.nist.gov/vuln/detail/CVE-2021-22816), [CVE-2021-30065](https://nvd.nist.gov/vuln/detail/CVE-2021-30065), [CVE-2022-22724](https://nvd.nist.gov/vuln/detail/CVE-2022-22724), [CVE-2022-24322](https://nvd.nist.gov/vuln/detail/CVE-2022-24322), [CVE-2022-24323](https://nvd.nist.gov/vuln/detail/CVE-2022-24323), [CVE-2022-28613](https://nvd.nist.gov/vuln/detail/CVE-2022-28613), [CVE-2022-37300](https://nvd.nist.gov/vuln/detail/CVE-2022-37300), [CVE-2022-37301](https://nvd.nist.gov/vuln/detail/CVE-2022-37301), [CVE-2022-45789](https://nvd.nist.gov/vuln/detail/CVE-2022-45789), [CVE-2022-4856](https://nvd.nist.gov/vuln/detail/CVE-2022-4856), [CVE-2022-4857](https://nvd.nist.gov/vuln/detail/CVE-2022-4857), [CVE-2023-0027](https://nvd.nist.gov/vuln/detail/CVE-2023-0027), [CVE-2023-25619](https://nvd.nist.gov/vuln/detail/CVE-2023-25619), [CVE-2022-2081](https://nvd.nist.gov/vuln/detail/CVE-2022-2081), [CVE-2023-1285](https://nvd.nist.gov/vuln/detail/CVE-2023-1285), [CVE-2023-1150](https://nvd.nist.gov/vuln/detail/CVE-2023-1150) |

## Documentations
- [Modbus Mesulog Standard Functions Help](http://www.mesulog.fr/help/modbus/index.html?page=read-device-identification-f43.html) - Description for Modbus standard functions
## Articles
- [Articles about Modbus](https://ozeki.hu/p_5841-modbus-protocol.html) - Ozeki
- [Introduction to Modbus and Modbus Function Codes](https://control.com/technical-articles/introduction-to-modbus-and-modbus-function-codes/) - Shawn Dietrich, Control Automation (2023)
## Conferences
- [Analyzing PIPEDREAM - Challenges in Testing an ICS Attack Toolkit](https://www.youtube.com/watch?v=_dz6VNYSSJ0) - Jimmy Wylie @ DEF CON 30 (2022)
- [Common Flaws in ICS Network Protocols](https://www.youtube.com/watch?v=Bhq4kC52Qg8) - Mars Cheng & Selmon Yang @ Hack In The Box (2020)
- [Fun with Modbus 0x5a Nothing New Still Relevant?](https://www.youtube.com/watch?v=A_B69Rifu1g) - Arnaud Soulli√© @ DEF CON 25 ICS Village (2017)
- [Industrial Control Systems : Pentesting PLCs 101 (Part 1/2)](https://www.youtube.com/watch?v=iGwm6-lyn2Y) - Arnaud Soullie @ Black Hat Europe (2014)
- [Industrial Control Systems : Pentesting PLCs 101 (Part 2/2)](https://www.youtube.com/watch?v=rP_Jys1_OJk) - Arnaud Soullie @ Black Hat Europe (2014)
- [Industrial Protocol Gateways Under Analysis](https://www.youtube.com/watch?v=Rbkw_jsTBsY) - Marco Balduzzi @ Black Hat USA (2020)
- [Industrial Protocol Gateways: A Deep-Dive of Moxa MGate 5105-MB-EIP](https://www.youtube.com/watch?v=tRi2te9yBuk) - Philippe Lin @ Hack In The Box (2020)
- [Modbus Enumeration | SANS ICS Concepts](https://www.youtube.com/watch?v=QO99yojavvE) - @ SANS ICS Security (2021)
- [Modbus Man-In-The-Middle | SANS ICS Concepts](https://www.youtube.com/watch?v=-1WbegoU8i0) - @ SANS ICS Security (2021)
- [Modbus Traffic Analysis | SANS ICS Concepts](https://www.youtube.com/watch?v=OAsLdXzKQo8) - @ SANS ICS Security (2021)
- [ModScan: A SCADA MODBUS Network Scanner](https://www.youtube.com/watch?v=O_trNBh31lM) - Mark Bristow @ DEF CON 16 (2013)
- [Out of Control: Demonstrating SCADA device exploitation](https://www.youtube.com/watch?v=FTzAkEnwx_c) - Eric Forner & Brian Meixell @ Black Hat USA (2013)
- [Stealing PLC Intellectual Property: A Red Teaming Story](https://www.youtube.com/watch?v=SWFt9T8sGX0) - Matteo Beccaro @ Hack In The Box (2017)
- [The SCADA That Didn't Cry Wolf- Who's Really Attacking Your ICS Devices](https://www.youtube.com/watch?v=0M8nVv0bz6k) - Kyle Wilhoit @ Black Hat USA (2013)
- [Understanding SCADA's Modbus Protocol](https://www.youtube.com/watch?v=oVDYaG2HInU) - Justin Searle @ Black Hat Asia (2015)
- [Unraveling SCADA Protocols Using Sulley Fuzzer](https://www.youtube.com/watch?v=UUta_Ord8GI) - Ganesh Devarajan @ DEF CON 15 (2014)
## Tools
- [ctmodbus](https://github.com/ControlThings-io/ctmodbus) - A tool to interact with the Modbus protocol
- [Malmod](https://github.com/mliras/malmod) - Scripts to attack Modicon M340 via UMAS
- [mbtget](https://github.com/sourceperl/mbtget) - A simple Modbus/TCP client in Perl
- [PyModbus](https://github.com/pymodbus-dev/pymodbus) - A full modbus protocol written in python
