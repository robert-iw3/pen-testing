from __future__ import annotations

import base64
from typing import List

# BOF imports
from core.gunnershell.bofs.base import Bof, register

# Session Management
from core.session_handlers import session_manager

# Command Execution Imports
from core.command_execution import http_command_execution as http_exec
from core.command_execution import tcp_command_execution as tcp_exec

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

@register("netview")
class NetViewBof(Bof):
	base64bof: str = "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AgAAAAAAzAAAAAAAAAAAAAAAAgAAAAAA5QAAAAAAAAAAAAAAAgAAAAAA/QAAAAAAAAAAAAAAAgAAAAAAIAEAAAAAAAAAAAAAAgAAAAAAPQEAAAAAAAAAAAAAAgAAAAAAXQEAAAAAAAAAAAAAAgAAAAAAcwEAAAAAAAAAAAAAAgCLAQAALnJkYXRhJHp6egBwcmludG91dHB1dABpbnRlcm5hbF9wcmludGYAVXRmMTZUb1V0ZjgAbmV0dmlld19lbnVtAC5yZGF0YSR6enoAY3VycmVudG91dHNpemUAX19pbXBfTVNWQ1JUJGNhbGxvYwBfX2ltcF9CZWFjb25PdXRwdXQAX19pbXBfTVNWQ1JUJGZyZWUAX19pbXBfTVNWQ1JUJHZzbnByaW50ZgBfX2ltcF9LRVJORUwzMiRHZXRQcm9jZXNzSGVhcABfX2ltcF9LRVJORUwzMiRIZWFwQWxsb2MAX19pbXBfS0VSTkVMMzIkSGVhcEZyZWUAX19pbXBfS2VybmVsMzIkV2lkZUNoYXJUb011bHRpQnl0ZQBfX2ltcF9ORVRBUEkzMiROZXRTZXJ2ZXJFbnVtAF9faW1wX05FVEFQSTMyJE5ldEFwaUJ1ZmZlckZyZWUAX19pbXBfQmVhY29uRGF0YVBhcnNlAF9faW1wX0JlYWNvbkRhdGFFeHRyYWN0AA=="
	x86base64bof: str = "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LnJkYXRhJHp6egAuZWhfZnJhbWUAX2JvZnN0YXJ0AF9wcmludG91dHB1dABfaW50ZXJuYWxfcHJpbnRmAF9VdGYxNlRvVXRmOABfbmV0dmlld19lbnVtAC5yZGF0YSR6enoALmVoX2ZyYW1lAF9jdXJyZW50b3V0c2l6ZQBfX2ltcF9fTVNWQ1JUJGNhbGxvYwBfX2ltcF9fQmVhY29uT3V0cHV0AF9faW1wX19NU1ZDUlQkZnJlZQBfX2ltcF9fTVNWQ1JUJHZzbnByaW50ZgBfX2ltcF9fS0VSTkVMMzIkR2V0UHJvY2Vzc0hlYXBAMABfX2ltcF9fS0VSTkVMMzIkSGVhcEFsbG9jQDEyAF9faW1wX19LRVJORUwzMiRIZWFwRnJlZUAxMgBfX2ltcF9fS2VybmVsMzIkV2lkZUNoYXJUb011bHRpQnl0ZUAzMgBfX2ltcF9fTkVUQVBJMzIkTmV0U2VydmVyRW51bUAzNgBfX2ltcF9fTkVUQVBJMzIkTmV0QXBpQnVmZmVyRnJlZUA0AF9faW1wX19CZWFjb25EYXRhUGFyc2UAX19pbXBfX0JlYWNvbkRhdGFFeHRyYWN0AA=="

	def help_menu():
		menu = """
Lists local workstations and servers
Usage: bofexec netview -z <optional netbios domain name>
"""
		print(brightgreen + menu + reset)
		return