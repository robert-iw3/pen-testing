from __future__ import annotations

import base64
from typing import List

# BOF imports
from core.gunnershell.bofs.base import Bof, register

# Session Management
from core.session_handlers import session_manager

# Command Execution Imports
from core.command_execution import http_command_execution as http_exec
from core.command_execution import tcp_command_execution as tcp_exec

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

@register("ipconfig")
class IpconfigBof(Bof):
	base64bof: str = "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"
	x86base64bof: str = "TAEGAAAAAAAaCgAAJAAAAAAABAEudGV4dAAAAAAAAAAAAAAAEAUAAAQBAADgBwAAAAAAADIAAAAgADBgLmRhdGEAAAAAAAAAAAAAAAwAAAAUBgAAAAAAAAAAAAAAAAAAQAAwwC5ic3MAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAMMAucmRhdGEAAAAAAAAAAAAAkAAAACAGAAAAAAAAAAAAAAAAAABAADBALzQAAAAAAAAAAAAAAAAAABQAAACwBgAAAAAAAAAAAAAAAAAAQAAwQC8xNQAAAAAAAAAAAAAAAAAcAQAAxAYAANQJAAAAAAAABwAAAEAAMEBVieWD7BjHRCQEAQAAAMcEJAAgAAD/FQAAAABmxwUEAAAAAACjCAAAALgBAAAAycNVMdKJ5VeD7BQPtwUEAAAAiRQkiUQkCKEIAAAAiUQkBP8VAAAAAIsVCAAAADHAuQAIAABmxwUEAAAAAACDfQgAidfzq3QQiRQk/xUAAAAAMcCjCAAAAIPEFF9dw1WJ5Vcx/1aNdQxTg+w8iXQkDItFCIl8JASJRCQIoQAAAACJPCSJRdz/0IP4/w+EJAEAAInDoQAAAACJReD/0Is9AAAAAMdEJAgAIAAAx0QkBAgAAACJBCT/14PsDIlF2ItF4P/QiVwkCMdEJAQIAAAAiQQk/9eD7AyJReSJdCQMi0UIiVwkBIlEJAiLReSJBCSLRdz/0A+3BQQAAACLdeSNDBiJddyB+f8fAAB/awMFCAAAAInZicfzpGYBHQQAAADrWg+3BQQAAAC5ACAAAIt13CnBOdmJyg9P0wMFCAAAAInHidHzpGahBAAAAAHQZqMEAAAAZj0AIHUQMfaJVdSJNCTonP7//4tV1It92DHAidEBVdwp0/Oqhdt/potF4P/Qi3XkMdKLHQAAAACJVCQEiXQkCIkEJP/Ti0Xgg+wM/9CLfdgxyYlMJASJfCQIiQQk/9OD7AyNZfRbXl9dw1UxyYnlV1ZTMduD7DyJTCQciUwkGIlMJBSJTCQQiw0AAAAAx0QkDP////+LRQiJXCQEiUQkCMcEJOn9AACJTeT/0Ys9AAAAAIPsIInG/9eJdCQIx0QkBAgAAACJBCT/FQAAAAAx0jHJg+wMicOJVCQciVQkGIl0JBSJRCQQx0QkDP////+LRQiJTCQEiUQkCMcEJOn9AACLTeT/0YPsIIXAdR6F23QY/9cx0olcJAiJVCQEiQQk/xUAAAAAg+wMMduNZfSJ2FteX13Dw1WJ5VdWU4PsPIs9AAAAAP/Xx0QkCABQAACLNQAAAADHRCQECAAAAIkEJP/WMcmD7AyJw41F5IlN4MdF5ABQAACJRCQEiRwk/xUAAAAAUlKFwHQax0QkBAAAAADHBCQNAAAA/xUAAAAA6aUBAACNReCJRCQEMcCJBCShAAAAAIlF1P/QUlKD+G91yYtV4IlV0P/Xi1XQx0QkBAgAAACJBCSJVCQI/9aD7AyJxoXAdKSNReCJNCSJRCQEi0XU/9BXV4nfhcAPhJAAAADHRCQEAAAAAMcEJA0AAAD/FQAAAADpEgEAAI1HCMcEJCMAAACJRCQE6N78//+Dv6ABAAAGdWDHRCQEJwAAAMcEJDIAAADowfz//42HDAEAAMcEJEMAAACJRCQE6Kv8///HBCRIAAAA6J/8//8xwIuXkAEAADnQciiNh7ABAADHBCRDAAAAiUQkBOh9/P//iz+F/3WG6znHRCQENQAAAOueD7aMB5QBAABKiUXUiUwkBDnCdQnHBCRKAAAA6wfHBCRQAAAA6EL8//+LRdRA65+JdCQExwQkVgAAAOgs/P//jYaEAAAAxwQkZQAAAIlEJAToFvz//42GEAEAAMcEJHYAAACJRCQE6AD8//+LvgwBAACF/3QXjUcExwQkhwAAAIlEJATo4/v//4s/6+X/FQAAAAAxyYl0JAiJTCQEiQQk/xUAAAAAg+wMhdt0HP8VAAAAADHSiVwkCIlUJASJBCT/FQAAAACD7AyNZfRbXl9dw1WJ5YPsCOgE+///6Lb9///HRQgBAAAAyeki+///kJAAAAAAAAAAAAAAAABjb3VsZCBub3QgZ2V0IG5ldHdvcmsgYWRhcHRlciBpbmZvACVzCgAJRXRoZXJuZXQKACVzAAlVbmtub3duVHlwZQoACSVzCgAJACUuMlgKACUuMlgtAEhvc3RuYW1lOiAJJXMKAEROUyBTdWZmaXg6IAklcwoARE5TIFNlcnZlcjogCSVzCgAJCSVzCgAAAABHQ0M6IChHTlUpIDE0LXdpbjMyABQAAAAAAAAAAXpSAAF8CAEbDAQEiAEAABwAAAAcAAAABAAAADAAAAAAQQ4IhQJCDQVsxQwEBAAAIAAAADwAAAA0AAAAXAAAAABBDgiFAkQNBUSHAwJRx0HFDAQELAAAAGAAAACQAAAAXwEAAABBDgiFAkINBUGHA0OGBEeDBQNNAcNBxkHHQcUMBAQAKAAAAJAAAADvAQAAywAAAABBDgiFAkQNBUOHA4YEgwUCv8NBxkHHQcUMBAQQAAAAvAAAALoCAAABAAAAAAAAACwAAADQAAAAuwIAADoCAAAAQQ4IhQJCDQVGhwOGBIMFAy0Cw0HGQcdBxQwEBAAAABwAAAAAAQAA9QQAAB0AAAAAQQ4IhQJCDQVVxQwEBAAAFwAAABkAAAAGAB4AAAAMAAAABgAlAAAADAAAAAYAPAAAAAwAAAAGAEgAAAAMAAAABgBSAAAAGgAAAAYAWAAAAAwAAAAGAGYAAAAMAAAABgB7AAAAGwAAAAYAggAAAAwAAAAGAKoAAAAcAAAABgDCAAAAHQAAAAYAzQAAAB4AAAAGACUBAAAMAAAABgA8AQAADAAAAAYASQEAAAwAAAAGAFIBAAAMAAAABgBpAQAADAAAAAYAdQEAAAwAAAAGAH0BAAAMAAAABgC1AQAAHwAAAAYACgIAACAAAAAGAC8CAAAdAAAABgBLAgAAHgAAAAYAowIAAB8AAAAGAMICAAAdAAAABgDSAgAAHgAAAAYAAAMAACEAAAAGAA4DAAAQAAAABgAbAwAAIgAAAAYAMQMAACMAAAAGAIUDAAAQAAAABgCSAwAAIgAAAAYAoQMAABAAAAAGALsDAAAQAAAABgDCAwAAEAAAAAYA1AMAABAAAAAGAOQDAAAQAAAABgACBAAAEAAAAAYAGwQAABAAAAAGADgEAAAQAAAABgBBBAAAEAAAAAYAVwQAABAAAAAGAGkEAAAQAAAABgB/BAAAEAAAAAYAnAQAABAAAAAGAK8EAAAdAAAABgDCBAAAHwAAAAYAzwQAAB0AAAAGAOIEAAAfAAAABgAgAAAACgAAABQAQAAAAAoAAAAUAGQAAAAKAAAAFACUAAAACgAAABQAwAAAAAoAAAAUANQAAAAKAAAAFAAEAQAACgAAABQALmZpbGUAAAAAAAAA/v8AAGcBZW50cnkuYwAAAAAAAAAAAAAAAAAAABkAAAAAAAAAAQAgAAIBAAAAAAAAAAAAAAAAAAAAAAAAAAAAACMAAAAwAAAAAQAgAAIAAAAAADAAAACMAAAAAQAgAAIAAAAAAEEAAADrAQAAAQAgAAIAX2JvZnN0b3C2AgAAAQAgAAIAAAAAAE4AAAC3AgAAAQAgAAIAX2dvAAAAAADxBAAAAQAgAAIALnRleHQAAAAAAAAAAQAAAAMBDgUAADIAAAAAAAAAAAAAAAAALmRhdGEAAAAAAAAAAgAAAAMBDAAAAAAAAAAAAAAAAAAAAAAALmJzcwAAAAAAAAAAAwAAAAMBAAAAAAAAAAAAAAAAAAAAAAAALnJkYXRhAAAAAAAABAAAAAMBjQAAAAAAAAAAAAAAAAAAAAAAAAAAAFkAAAAAAAAABQAAAAMBFAAAAAAAAAAAAAAAAAAAAAAAAAAAAGQAAAAAAAAABgAAAAMBHAEAAAcAAAAAAAAAAAAAAAAAAAAAAG4AAAAEAAAAAgAAAAIAX291dHB1dAAIAAAAAgAAAAIAX3RyYXNoAAAAAAAAAgAAAAIAAAAAAH4AAAAAAAAAAAAAAAIAAAAAAJMAAAAAAAAAAAAAAAIAAAAAAKcAAAAAAAAAAAAAAAIAAAAAALoAAAAAAAAAAAAAAAIAAAAAANIAAAAAAAAAAAAAAAIAAAAAAPMAAAAAAAAAAAAAAAIAAAAAABABAAAAAAAAAAAAAAIAAAAAACwBAAAAAAAAAAAAAAIAAAAAAFMBAAAAAAAAAAAAAAIAAAAAAHUBAAAAAAAAAAAAAAIAAAAAAIkBAAAAAAAAAAAAAAIArAEAAC5yZGF0YSR6enoALmVoX2ZyYW1lAF9ib2ZzdGFydABfcHJpbnRvdXRwdXQAX2ludGVybmFsX3ByaW50ZgBfVXRmMTZUb1V0ZjgAX2dldElQSW5mbwAucmRhdGEkenp6AC5laF9mcmFtZQBfY3VycmVudG91dHNpemUAX19pbXBfX01TVkNSVCRjYWxsb2MAX19pbXBfX0JlYWNvbk91dHB1dABfX2ltcF9fTVNWQ1JUJGZyZWUAX19pbXBfX01TVkNSVCR2c25wcmludGYAX19pbXBfX0tFUk5FTDMyJEdldFByb2Nlc3NIZWFwQDAAX19pbXBfX0tFUk5FTDMyJEhlYXBBbGxvY0AxMgBfX2ltcF9fS0VSTkVMMzIkSGVhcEZyZWVAMTIAX19pbXBfX0tlcm5lbDMyJFdpZGVDaGFyVG9NdWx0aUJ5dGVAMzIAX19pbXBfX0lQSExQQVBJJEdldEFkYXB0ZXJzSW5mb0A4AF9faW1wX19CZWFjb25QcmludGYAX19pbXBfX0lQSExQQVBJJEdldE5ldHdvcmtQYXJhbXNAOAA="

	def help_menu():
		menu = """
runs an internal ipconfig command
Lists out adapters, system hostname and configured dns server
"""

		print(brightgreen + menu + reset)
		return