from __future__ import annotations

import base64
from typing import List

# BOF imports
from core.gunnershell.bofs.base import Bof, register

# Session Management
from core.session_handlers import session_manager

# Command Execution Imports
from core.command_execution import http_command_execution as http_exec
from core.command_execution import tcp_command_execution as tcp_exec

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

@register("env")
class EnvBof(Bof):
	base64bof: str = "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AAADABAAAAAKAAAAAwAUAAAAEAAAAAMAGAAAAAoAAAADABwAAAAKAAAAAwAgAAAAEAAAAAMAJAAAAAoAAAADACgAAAAKAAAAAwAsAAAAEAAAAAMAMAAAAAoAAAADADQAAAAKAAAAAwA4AAAAEAAAAAMAPAAAAAoAAAADAEAAAAAKAAAAAwBEAAAAEAAAAAMASAAAAAoAAAADAEwAAAAKAAAAAwBQAAAAEAAAAAMALmZpbGUAAAAAAAAA/v8AAGcBZW50cnkuYwAAAAAAAAAAAAAAYm9mc3RhcnQAAAAAAQAgAAIBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAuAAAAAQAgAAIAAAAAABsAAACGAAAAAQAgAAIAAAAAACsAAAD0AQAAAQAgAAIAYm9mc3RvcAChAgAAAQAgAAIAZ2V0RW52cwCiAgAAAQAgAAIAZ28AAAAAAAAaAwAAAQAgAAIALnRleHQAAAAAAAAAAQAAAAMBNgMAACAAAAAAAAAAAAAAAAAALmRhdGEAAAAAAAAAAgAAAAMBGAAAAAAAAAAAAAAAAAAAAAAALmJzcwAAAAAAAAAAAwAAAAMBAAAAAAAAAAAAAAAAAAAAAAAALnhkYXRhAAAAAAAABAAAAAMBVAAAAAAAAAAAAAAAAAAAAAAALnBkYXRhAAAAAAAABQAAAAMBVAAAABUAAAAAAAAAAAAAAAAALnJkYXRhAAAAAAAABgAAAAMBTQAAAAAAAAAAAAAAAAAAAAAAAAAAADcAAAAAAAAABwAAAAMBFAAAAAAAAAAAAAAAAAAAAAAAAAAAAEIAAAAIAAAAAgAAAAIAb3V0cHV0AAAQAAAAAgAAAAIAdHJhc2gAAAAAAAAAAgAAAAIAAAAAAFEAAAAAAAAAAAAAAAIAAAAAAGUAAAAAAAAAAAAAAAIAAAAAAHgAAAAAAAAAAAAAAAIAAAAAAIoAAAAAAAAAAAAAAAIAAAAAAKEAAAAAAAAAAAAAAAIAAAAAAL8AAAAAAAAAAAAAAAIAAAAAANgAAAAAAAAAAAAAAAIAAAAAAPAAAAAAAAAAAAAAAAIAAAAAABMBAAAAAAAAAAAAAAIAAAAAADgBAAAAAAAAAAAAAAIAAAAAAEsBAAAAAAAAAAAAAAIAAAAAAGMBAAAAAAAAAAAAAAIAigEAAC5yZGF0YSR6enoAcHJpbnRvdXRwdXQAaW50ZXJuYWxfcHJpbnRmAFV0ZjE2VG9VdGY4AC5yZGF0YSR6enoAY3VycmVudG91dHNpemUAX19pbXBfTVNWQ1JUJGNhbGxvYwBfX2ltcF9CZWFjb25PdXRwdXQAX19pbXBfTVNWQ1JUJGZyZWUAX19pbXBfTVNWQ1JUJHZzbnByaW50ZgBfX2ltcF9LRVJORUwzMiRHZXRQcm9jZXNzSGVhcABfX2ltcF9LRVJORUwzMiRIZWFwQWxsb2MAX19pbXBfS0VSTkVMMzIkSGVhcEZyZWUAX19pbXBfS2VybmVsMzIkV2lkZUNoYXJUb011bHRpQnl0ZQBfX2ltcF9LRVJORUwzMiRHZXRFbnZpcm9ubWVudFN0cmluZ3MAX19pbXBfQmVhY29uUHJpbnRmAF9faW1wX0tFUk5FTDMyJGxzdHJsZW5BAF9faW1wX0tFUk5FTDMyJEZyZWVFbnZpcm9ubWVudFN0cmluZ3NBAA=="
	x86base64bof: str = "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AAAGACAAAAAKAAAAFABAAAAACgAAABQAZAAAAAoAAAAUAJQAAAAKAAAAFADAAAAACgAAABQA1AAAAAoAAAAUAPwAAAAKAAAAFAAuZmlsZQAAAAAAAAD+/wAAZwFlbnRyeS5jAAAAAAAAAAAAAAAAAAAAGQAAAAAAAAABACAAAgEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIwAAADAAAAABACAAAgAAAAAAMAAAAIwAAAABACAAAgAAAAAAQQAAAOsBAAABACAAAgBfYm9mc3RvcLYCAAABACAAAgBfZ2V0RW52c7cCAAABACAAAgBfZ28AAAAAACYDAAABACAAAgAudGV4dAAAAAAAAAABAAAAAwFEAwAAIAAAAAAAAAAAAAAAAAAuZGF0YQAAAAAAAAACAAAAAwEMAAAAAAAAAAAAAAAAAAAAAAAuYnNzAAAAAAAAAAADAAAAAwEAAAAAAAAAAAAAAAAAAAAAAAAucmRhdGEAAAAAAAAEAAAAAwFNAAAAAAAAAAAAAAAAAAAAAAAAAAAATgAAAAAAAAAFAAAAAwEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAWQAAAAAAAAAGAAAAAwEUAQAABwAAAAAAAAAAAAAAAAAAAAAAYwAAAAQAAAACAAAAAgBfb3V0cHV0AAgAAAACAAAAAgBfdHJhc2gAAAAAAAACAAAAAgAAAAAAcwAAAAAAAAAAAAAAAgAAAAAAiAAAAAAAAAAAAAAAAgAAAAAAnAAAAAAAAAAAAAAAAgAAAAAArwAAAAAAAAAAAAAAAgAAAAAAxwAAAAAAAAAAAAAAAgAAAAAA6AAAAAAAAAAAAAAAAgAAAAAABQEAAAAAAAAAAAAAAgAAAAAAIQEAAAAAAAAAAAAAAgAAAAAASAEAAAAAAAAAAAAAAgAAAAAAcAEAAAAAAAAAAAAAAgAAAAAAhAEAAAAAAAAAAAAAAgAAAAAAnwEAAAAAAAAAAAAAAgDJAQAALnJkYXRhJHp6egAuZWhfZnJhbWUAX2JvZnN0YXJ0AF9wcmludG91dHB1dABfaW50ZXJuYWxfcHJpbnRmAF9VdGYxNlRvVXRmOAAucmRhdGEkenp6AC5laF9mcmFtZQBfY3VycmVudG91dHNpemUAX19pbXBfX01TVkNSVCRjYWxsb2MAX19pbXBfX0JlYWNvbk91dHB1dABfX2ltcF9fTVNWQ1JUJGZyZWUAX19pbXBfX01TVkNSVCR2c25wcmludGYAX19pbXBfX0tFUk5FTDMyJEdldFByb2Nlc3NIZWFwQDAAX19pbXBfX0tFUk5FTDMyJEhlYXBBbGxvY0AxMgBfX2ltcF9fS0VSTkVMMzIkSGVhcEZyZWVAMTIAX19pbXBfX0tlcm5lbDMyJFdpZGVDaGFyVG9NdWx0aUJ5dGVAMzIAX19pbXBfX0tFUk5FTDMyJEdldEVudmlyb25tZW50U3RyaW5nc0AwAF9faW1wX19CZWFjb25QcmludGYAX19pbXBfX0tFUk5FTDMyJGxzdHJsZW5BQDQAX19pbXBfX0tFUk5FTDMyJEZyZWVFbnZpcm9ubWVudFN0cmluZ3NBQDQA"

	def help_menu():
		menu = """
Print environment variables.
env - Print environment variables for current process
"""

		print(brightgreen + menu + reset)
		return