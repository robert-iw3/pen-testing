from __future__ import annotations

# BOF imports
from core.gunnershell.bofs.base import Bof, register

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

@register("nettime")
class NetTimeBof(Bof):
	base64bof: str = "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AAACAAAAAABlAAAAAAAAAAAAAAACAAAAAAB4AAAAAAAAAAAAAAACAAAAAACKAAAAAAAAAAAAAAACAAAAAAChAAAAAAAAAAAAAAACAAAAAAC/AAAAAAAAAAAAAAACAAAAAADYAAAAAAAAAAAAAAACAAAAAADwAAAAAAAAAAAAAAACAAAAAAATAQAAAAAAAAAAAAACAAAAAAAvAQAAAAAAAAAAAAACAAAAAABDAQAAAAAAAAAAAAACAAAAAABZAQAAAAAAAAAAAAACAAAAAAB5AQAAAAAAAAAAAAACAAAAAACPAQAAAAAAAAAAAAACAKcBAAAucmRhdGEkenp6AHByaW50b3V0cHV0AGludGVybmFsX3ByaW50ZgBVdGYxNlRvVXRmOAAucmRhdGEkenp6AGN1cnJlbnRvdXRzaXplAF9faW1wX01TVkNSVCRjYWxsb2MAX19pbXBfQmVhY29uT3V0cHV0AF9faW1wX01TVkNSVCRmcmVlAF9faW1wX01TVkNSVCR2c25wcmludGYAX19pbXBfS0VSTkVMMzIkR2V0UHJvY2Vzc0hlYXAAX19pbXBfS0VSTkVMMzIkSGVhcEFsbG9jAF9faW1wX0tFUk5FTDMyJEhlYXBGcmVlAF9faW1wX0tlcm5lbDMyJFdpZGVDaGFyVG9NdWx0aUJ5dGUAX19pbXBfTkVUQVBJMzIkTmV0UmVtb3RlVE9EAF9faW1wX01TVkNSVCRnbXRpbWUAX19pbXBfTVNWQ1JUJHN0cmZ0aW1lAF9faW1wX05FVEFQSTMyJE5ldEFwaUJ1ZmZlckZyZWUAX19pbXBfQmVhY29uRGF0YVBhcnNlAF9faW1wX0JlYWNvbkRhdGFFeHRyYWN0AA=="
	x86base64bof: str = "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AgAAAAAASAEAAAAAAAAAAAAAAgAAAAAAZwEAAAAAAAAAAAAAAgAAAAAAfAEAAAAAAAAAAAAAAgAAAAAAkwEAAAAAAAAAAAAAAgAAAAAAtgEAAAAAAAAAAAAAAgAAAAAAzQEAAAAAAAAAAAAAAgDmAQAALnJkYXRhJHp6egAuZWhfZnJhbWUAX2JvZnN0YXJ0AF9wcmludG91dHB1dABfaW50ZXJuYWxfcHJpbnRmAF9VdGYxNlRvVXRmOAAucmRhdGEkenp6AC5laF9mcmFtZQBfY3VycmVudG91dHNpemUAX19pbXBfX01TVkNSVCRjYWxsb2MAX19pbXBfX0JlYWNvbk91dHB1dABfX2ltcF9fTVNWQ1JUJGZyZWUAX19pbXBfX01TVkNSVCR2c25wcmludGYAX19pbXBfX0tFUk5FTDMyJEdldFByb2Nlc3NIZWFwQDAAX19pbXBfX0tFUk5FTDMyJEhlYXBBbGxvY0AxMgBfX2ltcF9fS0VSTkVMMzIkSGVhcEZyZWVAMTIAX19pbXBfX0tlcm5lbDMyJFdpZGVDaGFyVG9NdWx0aUJ5dGVAMzIAX19pbXBfX05FVEFQSTMyJE5ldFJlbW90ZVRPREA4AF9faW1wX19NU1ZDUlQkZ210aW1lAF9faW1wX19NU1ZDUlQkc3RyZnRpbWUAX19pbXBfX05FVEFQSTMyJE5ldEFwaUJ1ZmZlckZyZWVANABfX2ltcF9fQmVhY29uRGF0YVBhcnNlAF9faW1wX19CZWFjb25EYXRhRXh0cmFjdAA="

	def help_menu():
		menu = """
Command: nettime
Summary: This command displays the current time on a remote host. 

Usage:
  Ex: bofexec nettime target 
  bofexec nettime target.domain.local 
  bofexec nettime  
"""
		print(brightgreen + menu + reset)
		return