import base64
from typing import List

# BOF imports
from core.gunnershell.bofs.base import Bof, register

# Session Management
from core.session_handlers import session_manager

# Command Execution Imports
from core.command_execution import http_command_execution as http_exec
from core.command_execution import tcp_command_execution as tcp_exec

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

@register("useridletime")
class UserIdleTimeBof(Bof):
	base64bof: str = "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AAADAAQAAAAKAAAAAwAIAAAAEAAAAAMADAAAAAoAAAADABAAAAAKAAAAAwAUAAAAEAAAAAMAGAAAAAoAAAADABwAAAAKAAAAAwAgAAAAEAAAAAMAJAAAAAoAAAADACgAAAAKAAAAAwAsAAAAEAAAAAMAMAAAAAoAAAADADQAAAAKAAAAAwA4AAAAEAAAAAMAPAAAAAoAAAADAEAAAAAKAAAAAwBEAAAAEAAAAAMASAAAAAoAAAADAEwAAAAKAAAAAwBQAAAAEAAAAAMALmZpbGUAAAAAAAAA/v8AAGcBZW50cnkuYwAAAAAAAAAAAAAAYm9mc3RhcnQAAAAAAQAgAAIBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAuAAAAAQAgAAIAAAAAABsAAACGAAAAAQAgAAIAAAAAACsAAAD0AQAAAQAgAAIAYm9mc3RvcAChAgAAAQAgAAIAAAAAADcAAACiAgAAAQAgAAIAZ28AAAAAAAA6AwAAAQAgAAIALnRleHQAAAAAAAAAAQAAAAMBVgMAAB0AAAAAAAAAAAAAAAAALmRhdGEAAAAAAAAAAgAAAAMBGAAAAAAAAAAAAAAAAAAAAAAALmJzcwAAAAAAAAAAAwAAAAMBAAAAAAAAAAAAAAAAAAAAAAAALnhkYXRhAAAAAAAABAAAAAMBUAAAAAAAAAAAAAAAAAAAAAAALnBkYXRhAAAAAAAABQAAAAMBVAAAABUAAAAAAAAAAAAAAAAALnJkYXRhAAAAAAAABgAAAAMBbQAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABwAAAAMBFAAAAAAAAAAAAAAAAAAAAAAAAAAAAE8AAAAIAAAAAgAAAAIAb3V0cHV0AAAQAAAAAgAAAAIAdHJhc2gAAAAAAAAAAgAAAAIAAAAAAF4AAAAAAAAAAAAAAAIAAAAAAHIAAAAAAAAAAAAAAAIAAAAAAIUAAAAAAAAAAAAAAAIAAAAAAJcAAAAAAAAAAAAAAAIAAAAAAK4AAAAAAAAAAAAAAAIAAAAAAMwAAAAAAAAAAAAAAAIAAAAAAOUAAAAAAAAAAAAAAAIAAAAAAP0AAAAAAAAAAAAAAAIAAAAAACABAAAAAAAAAAAAAAIAAAAAAD4BAAAAAAAAAAAAAAIAWgEAAC5yZGF0YSR6enoAcHJpbnRvdXRwdXQAaW50ZXJuYWxfcHJpbnRmAFV0ZjE2VG9VdGY4AHVzZXJJZGxldGltZQAucmRhdGEkenp6AGN1cnJlbnRvdXRzaXplAF9faW1wX01TVkNSVCRjYWxsb2MAX19pbXBfQmVhY29uT3V0cHV0AF9faW1wX01TVkNSVCRmcmVlAF9faW1wX01TVkNSVCR2c25wcmludGYAX19pbXBfS0VSTkVMMzIkR2V0UHJvY2Vzc0hlYXAAX19pbXBfS0VSTkVMMzIkSGVhcEFsbG9jAF9faW1wX0tFUk5FTDMyJEhlYXBGcmVlAF9faW1wX0tlcm5lbDMyJFdpZGVDaGFyVG9NdWx0aUJ5dGUAX19pbXBfVVNFUjMyJEdldExhc3RJbnB1dEluZm8AX19pbXBfS0VSTkVMMzIkR2V0VGlja0NvdW50AA=="
	x86base64bof: str = "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AAAhAAAABgDdAgAAIgAAAAYA8AIAABAAAAAGADwDAAAQAAAABgAgAAAACgAAABQAQAAAAAoAAAAUAGQAAAAKAAAAFACUAAAACgAAABQAwAAAAAoAAAAUANQAAAAKAAAAFAD4AAAACgAAABQALmZpbGUAAAAAAAAA/v8AAGcBZW50cnkuYwAAAAAAAAAAAAAAAAAAABkAAAAAAAAAAQAgAAIBAAAAAAAAAAAAAAAAAAAAAAAAAAAAACMAAAAwAAAAAQAgAAIAAAAAADAAAACMAAAAAQAgAAIAAAAAAEEAAADrAQAAAQAgAAIAX2JvZnN0b3C2AgAAAQAgAAIAAAAAAE4AAAC3AgAAAQAgAAIAX2dvAAAAAABKAwAAAQAgAAIALnRleHQAAAAAAAAAAQAAAAMBZwMAAB0AAAAAAAAAAAAAAAAALmRhdGEAAAAAAAAAAgAAAAMBDAAAAAAAAAAAAAAAAAAAAAAALmJzcwAAAAAAAAAAAwAAAAMBAAAAAAAAAAAAAAAAAAAAAAAALnJkYXRhAAAAAAAABAAAAAMBbQAAAAAAAAAAAAAAAAAAAAAAAAAAAFwAAAAAAAAABQAAAAMBFAAAAAAAAAAAAAAAAAAAAAAAAAAAAGcAAAAAAAAABgAAAAMBEAEAAAcAAAAAAAAAAAAAAAAAAAAAAHEAAAAEAAAAAgAAAAIAX291dHB1dAAIAAAAAgAAAAIAX3RyYXNoAAAAAAAAAgAAAAIAAAAAAIEAAAAAAAAAAAAAAAIAAAAAAJYAAAAAAAAAAAAAAAIAAAAAAKoAAAAAAAAAAAAAAAIAAAAAAL0AAAAAAAAAAAAAAAIAAAAAANUAAAAAAAAAAAAAAAIAAAAAAPYAAAAAAAAAAAAAAAIAAAAAABMBAAAAAAAAAAAAAAIAAAAAAC8BAAAAAAAAAAAAAAIAAAAAAFYBAAAAAAAAAAAAAAIAAAAAAHcBAAAAAAAAAAAAAAIAlgEAAC5yZGF0YSR6enoALmVoX2ZyYW1lAF9ib2ZzdGFydABfcHJpbnRvdXRwdXQAX2ludGVybmFsX3ByaW50ZgBfVXRmMTZUb1V0ZjgAX3VzZXJJZGxldGltZQAucmRhdGEkenp6AC5laF9mcmFtZQBfY3VycmVudG91dHNpemUAX19pbXBfX01TVkNSVCRjYWxsb2MAX19pbXBfX0JlYWNvbk91dHB1dABfX2ltcF9fTVNWQ1JUJGZyZWUAX19pbXBfX01TVkNSVCR2c25wcmludGYAX19pbXBfX0tFUk5FTDMyJEdldFByb2Nlc3NIZWFwQDAAX19pbXBfX0tFUk5FTDMyJEhlYXBBbGxvY0AxMgBfX2ltcF9fS0VSTkVMMzIkSGVhcEZyZWVAMTIAX19pbXBfX0tlcm5lbDMyJFdpZGVDaGFyVG9NdWx0aUJ5dGVAMzIAX19pbXBfX1VTRVIzMiRHZXRMYXN0SW5wdXRJbmZvQDQAX19pbXBfX0tFUk5FTDMyJEdldFRpY2tDb3VudEAwAA=="

	def help_menu():
		menu = """
Shows the user's idle time
Usage: bofexec useridletime
"""
		print(brightgreen + menu + reset)
		return