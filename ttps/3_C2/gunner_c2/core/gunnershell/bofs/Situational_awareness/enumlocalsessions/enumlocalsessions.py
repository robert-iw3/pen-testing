import base64
from typing import List

# BOF imports
from core.gunnershell.bofs.base import Bof, register

# Session Management
from core.session_handlers import session_manager

# Command Execution Imports
from core.command_execution import http_command_execution as http_exec
from core.command_execution import tcp_command_execution as tcp_exec

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

@register("enumlocalsessions")
class EnumLocalSessionsBof(Bof):
	base64bof: str = "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"
	x86base64bof: str = "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"

	def help_menu():
		menu = """
Enumerate the currently attached user sessions both local and over rdp
Usage: bofexec enumlocalsessions
"""
		print(brightgreen + menu + reset)
		return