import base64
from typing import List

# BOF imports
from core.gunnershell.bofs.base import Bof, register

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

@register("netshares")
class NetSharesBof(Bof):
	base64bof: str = "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AAADAFgAAAALAAAAAwBcAAAAEQAAAAMALmZpbGUAAAAAAAAA/v8AAGcBZW50cnkuYwAAAAAAAAAAAAAAYm9mc3RhcnQAAAAAAQAgAAIBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAuAAAAAQAgAAIAAAAAABsAAACGAAAAAQAgAAIAAAAAACsAAAD0AQAAAQAgAAIAYm9mc3RvcAChAgAAAQAgAAIAAAAAADcAAACiAgAAAQAgAAIAAAAAAEcAAACdAwAAAQAgAAIAZ28AAAAAAAB9BAAAAQAgAAIALnRleHQAAAAAAAAAAQAAAAMB9QQAACoAAAAAAAAAAAAAAAAALmRhdGEAAAAAAAAAAgAAAAMBGAAAAAAAAAAAAAAAAAAAAAAALmJzcwAAAAAAAAAAAwAAAAMBAAAAAAAAAAAAAAAAAAAAAAAALnhkYXRhAAAAAAAABAAAAAMBdAAAAAAAAAAAAAAAAAAAAAAALnBkYXRhAAAAAAAABQAAAAMBYAAAABgAAAAAAAAAAAAAAAAALnJkYXRhAAAAAAAABgAAAAMBzwAAAAAAAAAAAAAAAAAAAAAAAAAAAFYAAAAAAAAABwAAAAMBFAAAAAAAAAAAAAAAAAAAAAAAAAAAAGEAAAAIAAAAAgAAAAIAb3V0cHV0AAAQAAAAAgAAAAIAdHJhc2gAAAAAAAAAAgAAAAIAAAAAAHAAAAAAAAAAAAAAAAIAAAAAAIQAAAAAAAAAAAAAAAIAAAAAAJcAAAAAAAAAAAAAAAIAAAAAAKkAAAAAAAAAAAAAAAIAAAAAAMAAAAAAAAAAAAAAAAIAAAAAAN4AAAAAAAAAAAAAAAIAAAAAAPcAAAAAAAAAAAAAAAIAAAAAAA8BAAAAAAAAAAAAAAIAAAAAADIBAAAAAAAAAAAAAAIAAAAAAE4BAAAAAAAAAAAAAAIAAAAAAG4BAAAAAAAAAAAAAAIAAAAAAIQBAAAAAAAAAAAAAAIAAAAAAJwBAAAAAAAAAAAAAAIAsAEAAC5yZGF0YSR6enoAcHJpbnRvdXRwdXQAaW50ZXJuYWxfcHJpbnRmAFV0ZjE2VG9VdGY4AGxpc3RTaGFyZXNBZG1pbgBsaXN0U2hhcmVzVXNlcgAucmRhdGEkenp6AGN1cnJlbnRvdXRzaXplAF9faW1wX01TVkNSVCRjYWxsb2MAX19pbXBfQmVhY29uT3V0cHV0AF9faW1wX01TVkNSVCRmcmVlAF9faW1wX01TVkNSVCR2c25wcmludGYAX19pbXBfS0VSTkVMMzIkR2V0UHJvY2Vzc0hlYXAAX19pbXBfS0VSTkVMMzIkSGVhcEFsbG9jAF9faW1wX0tFUk5FTDMyJEhlYXBGcmVlAF9faW1wX0tlcm5lbDMyJFdpZGVDaGFyVG9NdWx0aUJ5dGUAX19pbXBfTkVUQVBJMzIkTmV0U2hhcmVFbnVtAF9faW1wX05FVEFQSTMyJE5ldEFwaUJ1ZmZlckZyZWUAX19pbXBfQmVhY29uRGF0YVBhcnNlAF9faW1wX0JlYWNvbkRhdGFFeHRyYWN0AF9faW1wX0JlYWNvbkRhdGFJbnQA"
	x86base64bof: str = "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MAAAAAEAIAACAAAAAAAwAAAAjAAAAAEAIAACAAAAAABBAAAA6wEAAAEAIAACAF9ib2ZzdG9wtgIAAAEAIAACAAAAAABOAAAAtwIAAAEAIAACAAAAAABfAAAAqAMAAAEAIAACAF9nbwAAAAAAfwQAAAEAIAACAC50ZXh0AAAAAAAAAAEAAAADAf4EAAAqAAAAAAAAAAAAAAAAAC5kYXRhAAAAAAAAAAIAAAADAQwAAAAAAAAAAAAAAAAAAAAAAC5ic3MAAAAAAAAAAAMAAAADAQAAAAAAAAAAAAAAAAAAAAAAAC5yZGF0YQAAAAAAAAQAAAADAc8AAAAAAAAAAAAAAAAAAAAAAAAAAABvAAAAAAAAAAUAAAADARQAAAAAAAAAAAAAAAAAAAAAAAAAAAB6AAAAAAAAAAYAAAADAVQBAAAIAAAAAAAAAAAAAAAAAAAAAACEAAAABAAAAAIAAAACAF9vdXRwdXQACAAAAAIAAAACAF90cmFzaAAAAAAAAAIAAAACAAAAAACUAAAAAAAAAAAAAAACAAAAAACpAAAAAAAAAAAAAAACAAAAAAC9AAAAAAAAAAAAAAACAAAAAADQAAAAAAAAAAAAAAACAAAAAADoAAAAAAAAAAAAAAACAAAAAAAJAQAAAAAAAAAAAAACAAAAAAAmAQAAAAAAAAAAAAACAAAAAABCAQAAAAAAAAAAAAACAAAAAABpAQAAAAAAAAAAAAACAAAAAACJAQAAAAAAAAAAAAACAAAAAACsAQAAAAAAAAAAAAACAAAAAADDAQAAAAAAAAAAAAACAAAAAADcAQAAAAAAAAAAAAACAPEBAAAucmRhdGEkenp6AC5laF9mcmFtZQBfYm9mc3RhcnQAX3ByaW50b3V0cHV0AF9pbnRlcm5hbF9wcmludGYAX1V0ZjE2VG9VdGY4AF9saXN0U2hhcmVzQWRtaW4AX2xpc3RTaGFyZXNVc2VyAC5yZGF0YSR6enoALmVoX2ZyYW1lAF9jdXJyZW50b3V0c2l6ZQBfX2ltcF9fTVNWQ1JUJGNhbGxvYwBfX2ltcF9fQmVhY29uT3V0cHV0AF9faW1wX19NU1ZDUlQkZnJlZQBfX2ltcF9fTVNWQ1JUJHZzbnByaW50ZgBfX2ltcF9fS0VSTkVMMzIkR2V0UHJvY2Vzc0hlYXBAMABfX2ltcF9fS0VSTkVMMzIkSGVhcEFsbG9jQDEyAF9faW1wX19LRVJORUwzMiRIZWFwRnJlZUAxMgBfX2ltcF9fS2VybmVsMzIkV2lkZUNoYXJUb011bHRpQnl0ZUAzMgBfX2ltcF9fTkVUQVBJMzIkTmV0U2hhcmVFbnVtQDI4AF9faW1wX19ORVRBUEkzMiROZXRBcGlCdWZmZXJGcmVlQDQAX19pbXBfX0JlYWNvbkRhdGFQYXJzZQBfX2ltcF9fQmVhY29uRGF0YUV4dHJhY3QAX19pbXBfX0JlYWNvbkRhdGFJbnQA"

	def help_menu():
		menu = """
List shares on local or remote computer
Usage: bofexec netshares -z [Optional: <\\computername>]
"""
		print(brightgreen + menu + reset)
		return