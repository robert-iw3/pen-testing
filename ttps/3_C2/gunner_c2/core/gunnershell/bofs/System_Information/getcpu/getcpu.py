import base64
from typing import List

# BOF imports
from core.gunnershell.bofs.base import Bof, register

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

@register("getcpu")
class GetCpuBof(Bof):
	base64bof: str = "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AAACAAAAAADDAAAAAAAAAAAAAAACAAAAAADhAAAAAAAAAAAAAAACAAAAAAD6AAAAAAAAAAAAAAACAAAAAAASAQAAAAAAAAAAAAACAAAAAAAmAQAAAAAAAAAAAAACAAAAAAA5AQAAAAAAAAAAAAACAAAAAABLAQAAAAAAAAAAAAACAAAAAABjAQAAAAAAAAAAAAACAAAAAAB6AQAAAAAAAAAAAAACAAAAAACOAQAAAAAAAAAAAAACAAAAAACqAQAAAAAAAAAAAAACAAAAAADNAQAAAAAAAAAAAAACAAAAAADwAQAAAAAAAAAAAAACAAAAAAATAgAAAAAAAAAAAAACAAAAAAAwAgAAAAAAAAAAAAACAAAAAABLAgAAAAAAAAAAAAACAAAAAABeAgAAAAAAAAAAAAACAAAAAACCAgAAAAAAAAAAAAACAAAAAACnAgAAAAAAAAAAAAACAAAAAAC7AgAAAAAAAAAAAAACAAAAAADPAgAAAAAAAAAAAAACAAAAAADjAgAAAAAAAAAAAAACAA8DAAAucmRhdGEkenp6AEdldERldlByb3BTdHJpbmdBAHByaW50b3V0cHV0AGludGVybmFsX3ByaW50ZgBQcmludFJlZ1NaAFV0ZjE2VG9VdGY4AFV0ZjhUb1V0ZjE2AEdVSURfREVWQ0xBU1NfUFJPQ0VTU09SAC5yZGF0YSR6enoAY3VycmVudG91dHNpemUAX19pbXBfU0VUVVBBUEkkU2V0dXBEaUdldERldmljZVJlZ2lzdHJ5UHJvcGVydHlBAF9faW1wX0tFUk5FTDMyJEdldFByb2Nlc3NIZWFwAF9faW1wX0tFUk5FTDMyJEhlYXBBbGxvYwBfX2ltcF9LRVJORUwzMiRIZWFwRnJlZQBfX2ltcF9NU1ZDUlQkY2FsbG9jAF9faW1wX0JlYWNvbk91dHB1dABfX2ltcF9NU1ZDUlQkZnJlZQBfX2ltcF9NU1ZDUlQkX3ZzY3ByaW50ZgBfX2ltcF9NU1ZDUlQkdnNucHJpbnRmAF9faW1wX01TVkNSVCRtZW1jcHkAX19pbXBfQURWQVBJMzIkUmVnR2V0VmFsdWVBAF9faW1wX0tFUk5FTDMyJFdpZGVDaGFyVG9NdWx0aUJ5dGUAX19pbXBfS0VSTkVMMzIkTXVsdGlCeXRlVG9XaWRlQ2hhcgBfX2ltcF9LRVJORUwzMiRHZXROYXRpdmVTeXN0ZW1JbmZvAF9faW1wX0FEVkFQSTMyJFJlZ09wZW5LZXlFeEEAX19pbXBfQURWQVBJMzIkUmVnQ2xvc2VLZXkAX19pbXBfQmVhY29uUHJpbnRmAF9faW1wX1NFVFVQQVBJJFNldHVwRGlHZXRDbGFzc0RldnNBAF9faW1wX1NFVFVQQVBJJFNldHVwRGlFbnVtRGV2aWNlSW5mbwBfX2ltcF9NU1ZDUlQkc3RybGVuAF9faW1wX01TVkNSVCRzdHJjcHkAX19pbXBfTVNWQ1JUJHN0cmNhdABfX2ltcF9TRVRVUEFQSSRTZXR1cERpRGVzdHJveURldmljZUluZm9MaXN0AA=="

	def help_menu():
		menu = """
getcpu â€” Enumerate basic CPU & driver info

Usage:
  bofexec getcpu

Output:
  - CPU architecture and logical processor count
  - Vendor/name, identifier, reported MHz, microcode revision
  - Processor device driver: provider, version, date, INF

Notes:
  - Reads HKLM\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor
  - Uses SetupAPI to query the Processor class (GUID_DEVCLASS_PROCESSOR)
  - No arguments required
"""
		print(brightgreen + menu + reset)
		return