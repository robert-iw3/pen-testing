import base64
from typing import List

# BOF imports
from core.gunnershell.bofs.base import Bof, register

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

@register("getbios")
class GetBIOsBof(Bof):
	base64bof: str = "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AAAAAAAAAAAAAFkAAAAIAAAAAgAAAAIAb3V0cHV0AAAQAAAAAgAAAAIAdHJhc2gAAAAAAAAAAgAAAAIAAAAAAGgAAAAAAAAAAAAAAAIAAAAAAHwAAAAAAAAAAAAAAAIAAAAAAI8AAAAAAAAAAAAAAAIAAAAAAKEAAAAAAAAAAAAAAAIAAAAAALkAAAAAAAAAAAAAAAIAAAAAANcAAAAAAAAAAAAAAAIAAAAAAPAAAAAAAAAAAAAAAAIAAAAAAAcBAAAAAAAAAAAAAAIAAAAAAB8BAAAAAAAAAAAAAAIAAAAAADMBAAAAAAAAAAAAAAIAAAAAAE8BAAAAAAAAAAAAAAIAAAAAAHIBAAAAAAAAAAAAAAIAAAAAAJUBAAAAAAAAAAAAAAIAAAAAALIBAAAAAAAAAAAAAAIAAAAAAMYBAAAAAAAAAAAAAAIAAAAAAOEBAAAAAAAAAAAAAAIAAAAAAPQBAAAAAAAAAAAAAAIAAAAAABMCAAAAAAAAAAAAAAIAOQIAAC5yZGF0YSR6enoAcHJpbnRvdXRwdXQAaW50ZXJuYWxfcHJpbnRmAFByaW50UmVnU1oAVXRmMTZUb1V0ZjgAVXRmOFRvVXRmMTYALnJkYXRhJHp6egBjdXJyZW50b3V0c2l6ZQBfX2ltcF9NU1ZDUlQkY2FsbG9jAF9faW1wX0JlYWNvbk91dHB1dABfX2ltcF9NU1ZDUlQkZnJlZQBfX2ltcF9NU1ZDUlQkX3ZzY3ByaW50ZgBfX2ltcF9LRVJORUwzMiRHZXRQcm9jZXNzSGVhcABfX2ltcF9LRVJORUwzMiRIZWFwQWxsb2MAX19pbXBfTVNWQ1JUJHZzbnByaW50ZgBfX2ltcF9LRVJORUwzMiRIZWFwRnJlZQBfX2ltcF9NU1ZDUlQkbWVtY3B5AF9faW1wX0FEVkFQSTMyJFJlZ0dldFZhbHVlQQBfX2ltcF9LRVJORUwzMiRXaWRlQ2hhclRvTXVsdGlCeXRlAF9faW1wX0tFUk5FTDMyJE11bHRpQnl0ZVRvV2lkZUNoYXIAX19pbXBfQURWQVBJMzIkUmVnT3BlbktleUV4QQBfX2ltcF9NU1ZDUlQkc3RybGVuAF9faW1wX0FEVkFQSTMyJFJlZ0Nsb3NlS2V5AF9faW1wX0JlYWNvblByaW50ZgBfX2ltcF9LRVJORUwzMiRHZXRGaXJtd2FyZVR5cGUAX19pbXBfS0VSTkVMMzIkR2V0U3lzdGVtRmlybXdhcmVUYWJsZQA="

	def help_menu():
		menu = """
getbios — Report BIOS / firmware info

Description
  Reads HKLM\\HARDWARE\\DESCRIPTION\\System\\BIOS and prints: BIOS Vendor/Version/Date,
  System Manufacturer/Product/Version/SKU/Family, BaseBoard Manufacturer/Product/Version.
  Also attempts to detect firmware type (UEFI vs Legacy BIOS) and SMBIOS version.

Usage
  bofexec getbios

Output
  BIOS Vendor     : <vendor>
  BIOS Version    : <version>
  BIOS ReleaseDate: <yyyy-mm-dd or vendor format>
  System Mfr      : <manufacturer>
  System Product  : <product>
  System Version  : <version>
  System SKU      : <sku>
  System Family   : <family>
  BaseBoard Mfr   : <manufacturer>
  BaseBoard Prod  : <product>
  BaseBoard Ver   : <version>
  OEM String(s)   :
    - <string1>
    - <string2>
  Firmware Type   : UEFI | Legacy BIOS | Unknown
  SMBIOS Version  : <major>.<minor> (DMI rev <n>)   [best-effort]

Notes
  • No WMI/COM required; registry + Win32 only.
  • Some fields may be missing on certain OEMs/VMs.
  • Requires read access to HKLM.
"""
		print(brightgreen + menu + reset)
		return