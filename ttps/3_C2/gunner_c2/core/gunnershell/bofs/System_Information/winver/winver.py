import base64
from typing import List

# BOF imports
from core.gunnershell.bofs.base import Bof, register

# Session Management
from core.session_handlers import session_manager

# Command Execution Imports
from core.command_execution import http_command_execution as http_exec
from core.command_execution import tcp_command_execution as tcp_exec

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

@register("winver")
class WinverBof(Bof):
	base64bof: str = "ZIYHAAAAAAA+CgAAGgAAAAAABAAudGV4dAAAAAAAAAAAAAAAUAUAACwBAACQCAAAAAAAAB8AAAAgAFBgLmRhdGEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQwC5ic3MAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAUMAueGRhdGEAAAAAAAAAAAAANAAAAHwGAAAAAAAAAAAAAAAAAABAADBALnBkYXRhAAAAAAAAAAAAADAAAACwBgAAxgkAAAAAAAAMAAAAQAAwQC5yZGF0YQAAAAAAAAAAAACQAQAA4AYAAAAAAAAAAAAAAAAAAEAAUEAvNAAAAAAAAAAAAAAAAAAAIAAAAHAIAAAAAAAAAAAAAAAAAABAAFBAZUyLFCVgAAAAZkGDuhgBAAAKdDpmQYO6GAEAAAZ1PGZBg7ocAQAAA3QmZkGDuhwBAAACdB1mQYO6HAEAAAF1G2ZBgbogAQAAsR10COsN/8D/wP/AQVpJicoPBcNIx8AMAAAA6Jj////DSMfADwAAAOiL////w0jHwBQAAADofv///8NTSDHbSDHAZUiLHCUwAAAASInYW8NVSInlSIPsYIlNEEiJVRjHRfwBAADASMdF8AAAAADHRcAwAAAASMdFyAAAAADHRdhAAAAASItFGEiJRdBIx0XgAAAAAEjHRegAAAAAi1UQSI1NwEiNRfBJichIicHob////4lF/IN9/AB0B7gAAAAA6wRIi0XwSIPEYF3DVVNIgeyIAAAASI2sJIAAAADHRfABAADASMdF6AAAAABIx0X4AAAAAMdFvAAAAADHRfQAAAAASI0FAAAAAEiJwUiLBQAAAAD/0EiJwUiNBQoAAABIicJIiwUAAAAA/9BIiUXgSIN94AB1CrgAAAAA6TsBAABIjUXQTItF4EiNFSAAAABIicFB/9BIjUXATItF4EiNFZ4AAABIicFB/9BIjUXQSInCuQEAAADo1f7//0iJRehIg33oAHUKuAAAAADp6wAAAEiNVcBIi0XoSI1NvEiJTCQox0QkIAAAAABBuQAAAABBuAEAAABIicHocf7//4lF8IF98CMAAMB1cItFvInDSIsFAAAAAP/QSYnYuggAAABIicFIiwUAAAAA/9BIiUX4i028TItN+EiNVcBIi0XoTI1FvEyJRCQoiUwkIEG4AQAAAEiJwegV/v//iUXwg33wAHUaSItF+ItACInCSItF+EgB0IsAiUX06wSQ6wGQSIN96AB0DEiLRehIicHoxP3//0iDffgAdCFIiwUAAAAA/9BIi1X4SYnQugAAAABIicFIiwUAAAAA/9CLRfRIgcSIAAAAW13DVUiJ5UiD7EBIx0X4AAAAAEiNBaYAAABIicFIiwUAAAAA/9BIiUXwSIN98AB1CrgAAAAA6YUAAABIjQWmAAAASInBSIsFAAAAAP/QSInBSI0FswAAAEiJwkiLBQAAAAD/0EiJRehIg33oAHUHuAAAAADrSkiLRehIjRXIAAAASInR/9BIiUX4SItF8EiJwUiLBQAAAAD/0EiLRfhIjRXIAAAASInBSIsFAAAAAP/QhcB1B7gAAAAA6wRIi0X4SIPEQF3DVUiJ5UiD7HBIiU0QiVUYSMdF+AAAAABIx0XwAAAAAEjHRegAAAAASMdF4AAAAADHRdwAAAAA6Lj8//9IiUXwSItF8EiLQDBIiUXoSItF6EiLQGBIiUXgSIN94AAPhEwBAABIi0Xgi5AcAQAASItF4IuIGAEAAEiNRcCJVCQgQYnJTI0F5gAAALoQAAAASInBSIsFAAAAAP/Q6J/+//9IiUX46N38//+JRdyDfdwAdHxIg334AHQ8SItF4A+3gCABAAAPt8hIi1X4i0XciUQkIEGJyUmJ0EiNBfIAAABIicK5AAAAAEiLBQAAAAD/0OmiAAAASItF4A+3gCABAAAPt8hIjVXAi0XciUQkIEGJyUmJ0EiNBRABAABIicK5AAAAAEiLBQAAAAD/0OtpSIN9+AB0MkiLReAPt4AgAQAAD7fQSItF+EGJ0UmJwEiNBT4BAABIicK5AAAAAEiLBQAAAAD/0OswSItF4A+3gCABAAAPt9BIjUXAQYnRSYnASI0FWAEAAEiJwrkAAAAASIsFAAAAAP/QSIN9+AB0FUiLRfhIicFIiwUAAAAA/9DrA5DrAZBIg8RwXcOQkJCQkJCQkAEIAwUIsgQDAVAAAAERBYURAwkBEQACMAFQAAABCAMFCHIEAwFQAAABCAMFCNIEAwFQAACYAAAAFAEAAAAAAAAUAQAAzQIAAAwAAADNAgAAkAMAABwAAACQAwAASAUAACgAAABudGRsbC5kbGwAUnRsSW5pdFVuaWNvZGVTdHJpbmcAAFwAUgBlAGcAaQBzAHQAcgB5AFwATQBhAGMAaABpAG4AZQBcAFMAbwBmAHQAdwBhAHIAZQBcAE0AaQBjAHIAbwBzAG8AZgB0AFwAVwBpAG4AZABvAHcAcwAgAE4AVABcAEMAdQByAHIAZQBuAHQAVgBlAHIAcwBpAG8AbgAAAFUAQgBSAAAAd2luYnJhbmQuZGxsAEJyYW5kaW5nRm9ybWF0U3RyaW5nACUAVwBJAE4ARABPAFcAUwBfAEwATwBOAEcAJQAAACUAdQAuACUAdQAAACVscywgT1MgYnVpbGQgbnVtYmVyOiAldS4ldQoAAFdpbmRvd3MgdmVyc2lvbjogJWxzLCBPUyBidWlsZCBudW1iZXI6ICV1LiV1CgAlbHMsIE9TIGJ1aWxkIG51bWJlcjogJXUKAFdpbmRvd3MgdmVyc2lvbjogJWxzLCBPUyBidWlsZCBudW1iZXI6ICV1CgAAAAAAAAAAAAAAAAAAR0NDOiAoR05VKSAxNC13aW4zMgAAAAAAAAAAAAAAAABNAQAADQAAAAQAVwEAAA8AAAAEAGMBAAANAAAABABtAQAAEAAAAAQAkwEAAA0AAAAEAKgBAAANAAAABAAZAgAAEQAAAAQALQIAABIAAAAEAKICAAARAAAABAC6AgAAEwAAAAQA4AIAAA0AAAAEAOoCAAAUAAAABAAIAwAADQAAAAQAEgMAAA8AAAAEAB4DAAANAAAABAAoAwAAEAAAAAQARwMAAA0AAAAEAF4DAAAVAAAABABrAwAADQAAAAQAdQMAABYAAAAEABQEAAANAAAABAAjBAAAFwAAAAQAaQQAAA0AAAAEAHgEAAAYAAAABAClBAAADQAAAAQAtAQAABgAAAAEAN4EAAANAAAABADtBAAAGAAAAAQAEAUAAA0AAAAEAB8FAAAYAAAABAA2BQAAGQAAAAQAAAAAAAkAAAADAAQAAAAJAAAAAwAIAAAACwAAAAMADAAAAAkAAAADABAAAAAJAAAAAwAUAAAACwAAAAMAGAAAAAkAAAADABwAAAAJAAAAAwAgAAAACwAAAAMAJAAAAAkAAAADACgAAAAJAAAAAwAsAAAACwAAAAMAAAAAAA8AAACYAAAAAQAgAAIBAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAUAQAAAQAgAAIAAAAAADQAAADNAgAAAQAgAAIAZ28AAAAAAACQAwAAAQAgAAIAAAAAAEkAAABpAAAAAQAgAAIAAAAAAFMAAAB2AAAAAQAgAAIAWndDbG9zZQBcAAAAAQAgAAIAAAAAAGMAAACDAAAAAQAgAAIALnRleHQAAAAAAAAAAQAAAAMBSAUAAB8AAAAAAAAAAAAAAAAALnhkYXRhAAAAAAAABAAAAAMBNAAAAAAAAAAAAAAAAAAAAAAALnJkYXRhAAAAAAAABgAAAAMBgwEAAAAAAAAAAAAAAAAAAAAAAAAAAG8AAAAAAAAAAAAAAAIAAAAAAIYAAAAAAAAAAAAAAAIAAAAAAJsAAAAAAAAAAAAAAAIAAAAAALkAAAAAAAAAAAAAAAIAAAAAANIAAAAAAAAAAAAAAAIAAAAAAOoAAAAAAAAAAAAAAAIAAAAAAP0AAAAAAAAAAAAAAAIAAAAAAA8BAAAAAAAAAAAAAAIAAAAAACUBAAAAAAAAAAAAAAIAAAAAAD0BAAAAAAAAAAAAAAIAAAAAAFABAAAAAAAAAAAAAAIAagEAAC5yZGF0YSR6enoAT3BlblJlZ0tleUhhbmRsZQBSZWFkVUJSRnJvbVJlZ2lzdHJ5AEdldE9TVmVyc2lvbkFzU3RyaW5nAFp3T3BlbktleQBad1F1ZXJ5VmFsdWVLZXkAR2V0VEVCQXNtNjQAX19pbXBfR2V0TW9kdWxlSGFuZGxlQQBfX2ltcF9HZXRQcm9jQWRkcmVzcwBfX2ltcF9LRVJORUwzMiRHZXRQcm9jZXNzSGVhcABfX2ltcF9LRVJORUwzMiRIZWFwQWxsb2MAX19pbXBfS0VSTkVMMzIkSGVhcEZyZWUAX19pbXBfTG9hZExpYnJhcnlBAF9faW1wX0ZyZWVMaWJyYXJ5AF9faW1wX01TVkNSVCRfd2NzaWNtcABfX2ltcF9NU1ZDUlQkc3dwcmludGZfcwBfX2ltcF9CZWFjb25QcmludGYAX19pbXBfS0VSTkVMMzIkR2xvYmFsRnJlZQA="
	x86base64bof: str = "TAEGAAAAAACQCQAAGAAAAAAABAEudGV4dAAAAAAAAAAAAAAA8AQAAAQBAAAoCAAAAAAAACAAAAAgADBgLmRhdGEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAwwC5ic3MAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAMMAucmRhdGEAAAAAAAAAAAAAhAEAAPQFAAAAAAAAAAAAAAAAAABAADBALzQAAAAAAAAAAAAAAAAAABQAAAB4BwAAAAAAAAAAAAAAAAAAQAAwQC8xNQAAAAAAAAAAAAAAAACcAAAAjAcAAGgJAAAAAAAABAAAAEAAMEBZVYnlZIsNMAAAAGaDuaQAAAAKdDVmg7mkAAAABnVMZoO5qAAAAAN0ImaDuagAAAACdBlmg7moAAAAAXUuZoG5rAAAALEddAXrIUBAQLkQAAAASf90jQh1+Y0dawAAAFNk/xXAAAAAjWQkBInsXcO4DAAAAOiH////w7gPAAAA6Hz////DuBQAAADocf///8NTMdsxwGSLHRgAAACJ2FvDVYnlg+w4x0X0AQAAwMdF8AAAAADHRdgYAAAAx0XcAAAAAMdF5EAAAACLRQyJReDHRegAAAAAx0XsAAAAAItFCI1V2IlUJAiJRCQEjUXwiQQk6IT///+JRfSDffQAdAe4AAAAAOsDi0XwycNVieVTg+xUx0XsAQAAwMdF6AAAAADHRfQAAAAAx0XQAAAAAMdF8AAAAADHBCQAAAAAoQAAAAD/0IPsBMdEJAQKAAAAiQQkoQAAAAD/0IPsCIlF5IN95AB1CrgAAAAA6UABAADHRCQEIAAAAI1F3IkEJItF5P/Qg+wIx0QkBJ4AAACNRdSJBCSLReT/0IPsCI1F3IlEJATHBCQBAAAA6PP+//+JReiDfegAdQq4AAAAAOnuAAAAjUXQiUQkFMdEJBAAAAAAx0QkDAAAAADHRCQIAQAAAI1F1IlEJASLReiJBCTolP7//4lF7IF97CMAAMB1cItd0KEAAAAA/9CJXCQIx0QkBAgAAACJBCShAAAAAP/Qg+wMiUX0i0XQjVXQiVQkFIlEJBCLRfSJRCQMx0QkCAEAAACNRdSJRCQEi0XoiQQk6DP+//+JReyDfewAdRWLRfSLUAiLRfQB0IsAiUXw6wSQ6wGQg33oAHQLi0XoiQQk6O39//+DffQAdCOhAAAAAP/Qi1X0iVQkCMdEJAQAAAAAiQQkoQAAAAD/0IPsDItF8Itd/MnDVYnlg+wox0X0AAAAAMcEJKYAAAChAAAAAP/Qg+wEiUXwg33wAHUHuAAAAADre8cEJKYAAAChAAAAAP/Qg+wEx0QkBLMAAACJBCShAAAAAP/Qg+wIiUXsg33sAHUHuAAAAADrRccEJMgAAACLRez/0IPsBIlF9ItF8IkEJKEAAAAA/9CD7ATHRCQEyAAAAItF9IkEJKEAAAAA/9CFwHUHuAAAAADrA4tF9MnDVYnlg+xYx0X0AAAAAMdF8AAAAADHRewAAAAAx0XoAAAAAMdF5AAAAADoBP3//4lF8ItF8ItAGIlF7ItF7ItAMIlF6IN96AAPhD0BAACLReiLkKgAAACLReiLgKQAAACJVCQQiUQkDMdEJAjmAAAAx0QkBBAAAACNRdSJBCShAAAAAP/Q6Mz+//+JRfToHP3//4lF5IN95AB0d4N99AB0OotF6A+3gKwAAAAPt8CLVeSJVCQQiUQkDItF9IlEJAjHRCQE8gAAAMcEJAAAAAChAAAAAP/Q6ZsAAACLRegPt4CsAAAAD7fAi1XkiVQkEIlEJAyNRdSJRCQIx0QkBBABAADHBCQAAAAAoQAAAAD/0Otkg330AHQwi0XoD7eArAAAAA+3wIlEJAyLRfSJRCQIx0QkBD4BAADHBCQAAAAAoQAAAAD/0Osui0XoD7eArAAAAA+3wIlEJAyNRdSJRCQIx0QkBFgBAADHBCQAAAAAoQAAAAD/0IN99AB0EotF9IkEJKEAAAAA/9DrA5DrAZDJw5CQbnRkbGwuZGxsAFJ0bEluaXRVbmljb2RlU3RyaW5nAABcAFIAZQBnAGkAcwB0AHIAeQBcAE0AYQBjAGgAaQBuAGUAXABTAG8AZgB0AHcAYQByAGUAXABNAGkAYwByAG8AcwBvAGYAdABcAFcAaQBuAGQAbwB3AHMAIABOAFQAXABDAHUAcgByAGUAbgB0AFYAZQByAHMAaQBvAG4AAABVAEIAUgAAAHdpbmJyYW5kLmRsbABCcmFuZGluZ0Zvcm1hdFN0cmluZwAlAFcASQBOAEQATwBXAFMAXwBMAE8ATgBHACUAAAAlAHUALgAlAHUAAAAlbHMsIE9TIGJ1aWxkIG51bWJlcjogJXUuJXUKAABXaW5kb3dzIHZlcnNpb246ICVscywgT1MgYnVpbGQgbnVtYmVyOiAldS4ldQoAJWxzLCBPUyBidWlsZCBudW1iZXI6ICV1CgBXaW5kb3dzIHZlcnNpb246ICVscywgT1MgYnVpbGQgbnVtYmVyOiAldQoAAEdDQzogKEdOVSkgMTQtd2luMzIAFAAAAAAAAAABelIAAXwIARsMBASIAQAAHAAAABwAAACkAAAAawAAAABBDgiFAkINBQJnxQwEBAAgAAAAPAAAAA8BAACoAQAAAEEOCIUCQg0FRIMDA6ABxcMMBAQcAAAAYAAAALcCAACrAAAAAEEOCIUCQg0FAqfFDAQEABwAAACAAAAAYgMAAJABAAAAQQ4IhQJCDQUDjAHFDAQEWwAAAAkAAAAGADgBAAALAAAABgA9AQAADQAAAAYASgEAAAsAAAAGAFIBAAAOAAAABgByAQAACwAAAAYAiAEAAAsAAAAGAAECAAAPAAAABgAXAgAAEAAAAAYAiQIAAA8AAAAGAKICAAARAAAABgDDAgAACwAAAAYAyAIAABIAAAAGAOQCAAALAAAABgDpAgAADQAAAAYA9gIAAAsAAAAGAP4CAAAOAAAABgAaAwAACwAAAAYAMAMAABMAAAAGAD0DAAALAAAABgBIAwAAFAAAAAYAyQMAAAsAAAAGANwDAAAVAAAABgAhBAAACwAAAAYALQQAABYAAAAGAFsEAAALAAAABgBnBAAAFgAAAAYAkQQAAAsAAAAGAJ0EAAAWAAAABgDBBAAACwAAAAYAzQQAABYAAAAGAOAEAAAXAAAABgAgAAAACQAAABQAQAAAAAkAAAAUAGQAAAAJAAAAFACEAAAACQAAABQAAAAAABkAAACgAAAAAQAgAAIBAAAAAAAAAAAAAAAAAAAAAAAAAAAAACoAAAALAQAAAQAgAAIAAAAAAD4AAACzAgAAAQAgAAIAZ28AAAAAAABeAwAAAQAgAAIAAAAAAFMAAAB6AAAAAQAgAAIAAAAAAF0AAACFAAAAAQAgAAIAWndDbG9zZQBvAAAAAQAgAAIAAAAAAG0AAACQAAAAAQAgAAIALnRleHQAAAAAAAAAAQAAAAMB7gQAACAAAAAAAAAAAAAAAAAALnJkYXRhAAAAAAAABAAAAAMBgwEAAAAAAAAAAAAAAAAAAAAAAAAAAHkAAAAAAAAAAAAAAAIAAAAAAJIAAAAAAAAAAAAAAAIAAAAAAKkAAAAAAAAAAAAAAAIAAAAAAMkAAAAAAAAAAAAAAAIAAAAAAOUAAAAAAAAAAAAAAAIAAAAAAAABAAAAAAAAAAAAAAIAAAAAABUBAAAAAAAAAAAAAAIAAAAAACkBAAAAAAAAAAAAAAIAAAAAAD8BAAAAAAAAAAAAAAIAAAAAAFcBAAAAAAAAAAAAAAIAAAAAAGoBAAAAAAAAAAAAAAIAhAEAAC5yZGF0YSR6enoALmVoX2ZyYW1lAE9wZW5SZWdLZXlIYW5kbGUAUmVhZFVCUkZyb21SZWdpc3RyeQBHZXRPU1ZlcnNpb25Bc1N0cmluZwBad09wZW5LZXkAWndRdWVyeVZhbHVlS2V5AEdldFRFQkFzbTY0AF9faW1wX0dldE1vZHVsZUhhbmRsZUFANABfX2ltcF9HZXRQcm9jQWRkcmVzc0A4AF9faW1wX0tFUk5FTDMyJEdldFByb2Nlc3NIZWFwQDAAX19pbXBfS0VSTkVMMzIkSGVhcEFsbG9jQDEyAF9faW1wX0tFUk5FTDMyJEhlYXBGcmVlQDEyAF9faW1wX0xvYWRMaWJyYXJ5QUA0AF9faW1wX0ZyZWVMaWJyYXJ5QDQAX19pbXBfTVNWQ1JUJF93Y3NpY21wAF9faW1wX01TVkNSVCRzd3ByaW50Zl9zAF9faW1wX0JlYWNvblByaW50ZgBfX2ltcF9LRVJORUwzMiRHbG9iYWxGcmVlAA=="

	def help_menu():
		menu = """
Display the version of Windows that is running, the build number and patch release (Update Build Revision).
Usage: bofexec winver
"""
		print(brightgreen + menu + reset)
		return