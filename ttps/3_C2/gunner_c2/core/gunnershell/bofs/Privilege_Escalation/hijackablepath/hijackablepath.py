import base64
from typing import List

# BOF imports
from core.gunnershell.bofs.base import Bof, register

# Session Management
from core.session_handlers import session_manager

# Command Execution Imports
from core.command_execution import http_command_execution as http_exec
from core.command_execution import tcp_command_execution as tcp_exec

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

@register("hijackpath")
class HijackPathBof(Bof):
	base64bof: str = "ZIYHAAAAAABaBQAAGAAAAAAABAAudGV4dAAAAAAAAAAAAAAA8AEAACwBAAB0BAAAAAAAABQAAAAgAFBgLmRhdGEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQwC5ic3MAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAUMAucmRhdGEAAAAAAAAAAAAAIAEAABwDAAAAAAAAAAAAAAAAAABAAFBALnhkYXRhAAAAAAAAAAAAAAwAAAA8BAAAAAAAAAAAAAAAAAAAQAAwQC5wZGF0YQAAAAAAAAAAAAAMAAAASAQAADwFAAAAAAAAAwAAAEAAMEAvNAAAAAAAAAAAAAAAAAAAIAAAAFQEAAAAAAAAAAAAAAAAAABAAFBAVUiB7GAEAABIjawkgAAAAEiNhcADAABIiUQkIEG5GQACAEG4AAAAAEiNBQAAAABIicJIx8ECAACASIsFAAAAAP/QiYXUAwAAg73UAwAAAHQhi4XUAwAAQYnASI0FQAAAAEiJwrkAAAAASIsFAAAAAP/QSIuFwAMAAEiNjbwDAABIjZW4AwAASIlUJChIjVWwSIlUJCBJiclBuAAAAABIjRVgAAAASInBSIsFAAAAAP/QiYXQAwAAg73QAwAAAHQ0i4XQAwAAQYnASI0FaAAAAEiJwrkAAAAASIsFAAAAAP/QSIuFwAMAAEiJwUiLBQAAAAD/0EiNRbBIjRWLAAAASInBSIsFAAAAAP/QSImF2AMAAOmSAAAASIuF2AMAAEiJwUiLBQAAAAD/0ImFzAMAAIO9zAMAAP90UYuFzAMAAIPgEIXAdESLhcwDAACD4BCFwHQ3SIuF2AMAAEmJwEiNBZAAAABIicK5AAAAAEiLBQAAAAD/0EiLhcADAABIicFIiwUAAAAA/9DrWUiNBYsAAABIicK5AAAAAEiLBQAAAAD/0EiJhdgDAABIg73YAwAAAA+FYP///0iNBdgAAABIicK5AAAAAEiLBQAAAAD/0EiLhcADAABIicFIiwUAAAAA/9CQSIHEYAQAAF3DkJCQkFNZU1RFTVxDdXJyZW50Q29udHJvbFNldFxDb250cm9sXFNlc3Npb24gTWFuYWdlclxFbnZpcm9ubWVudAAAAABFcnJvciBvcGVuaW5nIHJlZ2lzdHJ5IGtleTogJWQKAFBhdGgAAAAARXJyb3IgcXVlcnlpbmcgcmVnaXN0cnkgdmFsdWU6ICVkCgA7AAAAAEhpamFja2FibGUgUGF0aCBDaGVjayBSZXN1bHQ6IEZvdW5kIHdyaXRhYmxlIGRpcmVjdG9yeSBpbiBwYXRoOiAlcwoAAAAAAEhpamFja2FibGUgUGF0aCBDaGVjayBSZXN1bHQ6IE5vIHdyaXRhYmxlIGRpcmVjdG9yeSBmb3VuZCBpbiBwYXRoCgAAAAAAAAEQBIUQAwgBjAABUAAAAADsAQAAAAAAAEdDQzogKEdOVSkgMTQtd2luMzIAAAAAAAAAAAAAAAAAKwAAAAoAAAAEADwAAAASAAAABABdAAAACgAAAAQAbAAAABMAAAAEAKEAAAAKAAAABACrAAAAFAAAAAQAzAAAAAoAAAAEANsAAAATAAAABADuAAAAFQAAAAQA+wAAAAoAAAAEAAUBAAAWAAAABAAkAQAAFwAAAAQAYAEAAAoAAAAEAG8BAAATAAAABACCAQAAFQAAAAQAjQEAAAoAAAAEAJwBAAAWAAAABAC6AQAACgAAAAQAyQEAABMAAAAEANwBAAAVAAAABAAAAAAABAAAAAMABAAAAAQAAAADAAgAAAAMAAAAAwAuZmlsZQAAAAAAAAD+/wAAZwFoaWphY2thYmxlcGF0aAAAAABnbwAAAAAAAAAAAAABACAAAgEAAAAAAAAAAAAAAAAAAAAAAAAudGV4dAAAAAAAAAABAAAAAwHsAQAAFAAAAAAAAAAAAAAAAAAuZGF0YQAAAAAAAAACAAAAAwEAAAAAAAAAAAAAAAAAAAAAAAAuYnNzAAAAAAAAAAADAAAAAwEAAAAAAAAAAAAAAAAAAAAAAAAucmRhdGEAAAAAAAAEAAAAAwEbAQAAAAAAAAAAAAAAAAAAAAAueGRhdGEAAAAAAAAFAAAAAwEMAAAAAAAAAAAAAAAAAAAAAAAucGRhdGEAAAAAAAAGAAAAAwEMAAAAAwAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAHAAAAAwEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAGgAAAAAAAAAAAAAAAgAAAAAANwAAAAAAAAAAAAAAAgAAAAAASgAAAAAAAAAAAAAAAgAAAAAAagAAAAAAAAAAAAAAAgAAAAAAhQAAAAAAAAAAAAAAAgAAAAAAmQAAAAAAAAAAAAAAAgC7AAAALnJkYXRhJHp6egAucmRhdGEkenp6AF9faW1wX0FkdmFwaTMyJFJlZ09wZW5LZXlFeEEAX19pbXBfQmVhY29uUHJpbnRmAF9faW1wX0FkdmFwaTMyJFJlZ1F1ZXJ5VmFsdWVFeEEAX19pbXBfQWR2YXBpMzIkUmVnQ2xvc2VLZXkAX19pbXBfTVNWQ1JUJHN0cnRvawBfX2ltcF9LZXJuZWwzMiRHZXRGaWxlQXR0cmlidXRlc0EA"

	def help_menu():
		menu = """
Checks For Hijackable Paths
Usage: bofexec hijackpath
"""
		print(brightgreen + menu + reset)
		return