import base64
import re
from typing import List

# BOF imports
from core.gunnershell.bofs.base import Bof, register

from colorama import Style, Fore
brightgreen = "\001" + Style.BRIGHT + Fore.GREEN + "\002"
brightyellow = "\001" + Style.BRIGHT + Fore.YELLOW + "\002"
reset = Style.RESET_ALL

def _is_ip(s: str) -> bool:
	if not s: return False
	s = s.strip()
	# IPv6 (very loose): contains ':' or starts with '['
	if ':' in s or s.startswith('['): return True
	# IPv4 strict-ish
	m = re.match(r'^\d{1,3}(\.\d{1,3}){3}$', s)
	if not m: return False
	parts = s.split('.')
	return all(0 <= int(p) <= 255 for p in parts)


@register("adusers")
class ADUsersBof(Bof):
	base64bof: str = "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AAAAAAAAAAAAAAIAAAAAAMoDAAAAAAAAAAAAAAIA5AMAAC5yZGF0YSR6enoAcHJpbnRvdXRwdXQAaW50ZXJuYWxfcHJpbnRmAFV0ZjE2VG9VdGY4AFV0ZjhUb1V0ZjE2AF9fX2Noa3N0a19tcwBfX2Noa3N0a19tcwBkZWZBdHRycy4wAC5yZGF0YSR6enoAY3VycmVudG91dHNpemUAX19pbXBfTVNWQ1JUJGNhbGxvYwBfX2ltcF9CZWFjb25PdXRwdXQAX19pbXBfTVNWQ1JUJGZyZWUAX19pbXBfTVNWQ1JUJF92c2NwcmludGYAX19pbXBfS0VSTkVMMzIkR2V0UHJvY2Vzc0hlYXAAX19pbXBfS0VSTkVMMzIkSGVhcEFsbG9jAF9faW1wX01TVkNSVCR2c25wcmludGYAX19pbXBfS0VSTkVMMzIkSGVhcEZyZWUAX19pbXBfTVNWQ1JUJG1lbWNweQBfX2ltcF9LRVJORUwzMiRXaWRlQ2hhclRvTXVsdGlCeXRlAF9faW1wX0tFUk5FTDMyJE11bHRpQnl0ZVRvV2lkZUNoYXIAX19pbXBfQmVhY29uRGF0YVBhcnNlAF9faW1wX0JlYWNvbkRhdGFFeHRyYWN0AF9faW1wX0JlYWNvbkRhdGFJbnQAX19pbXBfV0xEQVAzMiRsZGFwX3NzbGluaXRXAF9faW1wX1dMREFQMzIkbGRhcF9pbml0VwBfX2ltcF9CZWFjb25QcmludGYAX19pbXBfV0xEQVAzMiRsZGFwX3NldF9vcHRpb25XAF9faW1wX1dMREFQMzIkbGRhcF9jb25uZWN0AF9faW1wX1dMREFQMzIkbGRhcF9iaW5kX3NXAF9faW1wX01TVkNSVCRfc253cHJpbnRmAF9faW1wX1dMREFQMzIkbGRhcF9zZWFyY2hfc1cAX19pbXBfV0xEQVAzMiRsZGFwX2ZpcnN0X2VudHJ5AF9faW1wX1dMREFQMzIkbGRhcF9nZXRfdmFsdWVzVwBfX2ltcF9XTERBUDMyJGxkYXBfdmFsdWVfZnJlZVcAX19pbXBfV0xEQVAzMiRsZGFwX21zZ2ZyZWUAX19pbXBfTVNWQ1JUJHdjc2xlbgBfX2ltcF9XTERBUDMyJGxkYXBfZmlyc3RfYXR0cmlidXRlVwBfX2ltcF9XTERBUDMyJGxkYXBfbWVtZnJlZVcAX19pbXBfV0xEQVAzMiRsZGFwX25leHRfYXR0cmlidXRlVwBfX2ltcF9XTERBUDMyJGJlcl9mcmVlAF9faW1wX1dMREFQMzIkbGRhcF9uZXh0X2VudHJ5AF9faW1wX1dMREFQMzIkbGRhcF91bmJpbmQA"
	x86base64bof: str = "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YUV4dHJhY3QAX19pbXBfX0JlYWNvbkRhdGFJbnQAX19pbXBfX1dMREFQMzIkbGRhcF9zc2xpbml0VwBfX2ltcF9fV0xEQVAzMiRsZGFwX2luaXRXAF9faW1wX19CZWFjb25QcmludGYAX19pbXBfX1dMREFQMzIkbGRhcF9zZXRfb3B0aW9uVwBfX2ltcF9fV0xEQVAzMiRsZGFwX2Nvbm5lY3QAX19pbXBfX1dMREFQMzIkbGRhcF9iaW5kX3NXAF9faW1wX19NU1ZDUlQkX3Nud3ByaW50ZgBfX2ltcF9fV0xEQVAzMiRsZGFwX3NlYXJjaF9zVwBfX2ltcF9fV0xEQVAzMiRsZGFwX2ZpcnN0X2VudHJ5AF9faW1wX19XTERBUDMyJGxkYXBfZ2V0X3ZhbHVlc1cAX19pbXBfX1dMREFQMzIkbGRhcF92YWx1ZV9mcmVlVwBfX2ltcF9fV0xEQVAzMiRsZGFwX21zZ2ZyZWUAX19pbXBfX01TVkNSVCR3Y3NsZW4AX19pbXBfX1dMREFQMzIkbGRhcF9maXJzdF9hdHRyaWJ1dGVXAF9faW1wX19XTERBUDMyJGxkYXBfbWVtZnJlZVcAX19pbXBfX1dMREFQMzIkbGRhcF9uZXh0X2F0dHJpYnV0ZVcAX19pbXBfX1dMREFQMzIkYmVyX2ZyZWUAX19pbXBfX1dMREFQMzIkbGRhcF9uZXh0X2VudHJ5AF9faW1wX19XTERBUDMyJGxkYXBfdW5iaW5kAA=="

	def help_menu():
		menu = """
adusers — Enumerate Active Directory users

Usage
  bofexec adusers [--users] [--basedn <DN>] [--filter <LdapFilter>] [-a <attr,attr,...>] [--user <UPN/DN>] [--password <str>]

Flags:
  --dc <hostname>       Hostname/FQDN of Domain Controller (wide). If omitted -> DC locator (NULL) NOTE: IPs are blocked; use a hostname.
  --ldaps               Use LDAPS (default port 636). If not set -> LDAP (default port 389).
  --port <int>          Override port. If 0/omitted -> defaults by scheme.

  --users               List only sAMAccountName
  --basedn <DN>         Custom Base DN (wide). Default: RootDSE defaultNamingContext
  --filter <filter>     Custom LDAP filter (wide). Default: (&(objectCategory=person)(objectClass=user))
  -a, --attributes <csv>  Comma-separated attributes or "*" for all
  --user <UPN/DN>       Simple bind user (optional; if omitted -> Negotiate)
  --password <str>      Simple bind password

Description
  • By default binds with Negotiate using the current process token.
  • If --user and --password are supplied, uses simple bind with those creds.
  • If --basedn is omitted, resolves RootDSE defaultNamingContext.
  • If --filter is omitted, uses: (&(objectCategory=person)(objectClass=user))
  • If --users is set, prints only sAMAccountName (one per line).
  • Otherwise prints requested attributes (comma-separated).
	Use -a "*" to dump all attributes on each entry.

Examples
  bofexec adusers --users
  bofexec adusers --filter "(&(objectCategory=person)(objectClass=user)(mail=*@contoso.com))" -a "sAMAccountName,mail"
  bofexec adusers --basedn "DC=contoso,DC=com" --user reader@contoso.com --password S3cret! -a "*"
"""
		print(brightgreen + menu + reset)
		return

	@staticmethod
	def args_inject(p):
		# Connection
		p.add_argument("--dc", default="", help="Domain Controller hostname (no IPs). Empty => DC locator")
		p.add_argument("--ldaps", default=False, action="store_true", help="Use LDAPS (default port 636)")
		p.add_argument("--port", type=int, default=0, help="LDAP/LDAPS port (0 => default by scheme)")

		# Search/Output
		p.add_argument("--users", action="store_true", default=False, help="List only sAMAccountName")
		p.add_argument("--basedn", default="", help="Base DN (wide). Default: RootDSE")
		p.add_argument("--filter", default="", help="LDAP filter (wide). Default: user filter")
		p.add_argument("-a", "--attributes", dest="attributes", default="", help="CSV of attributes, or \"*\"")
		p.add_argument("--user", default="", help="Simple bind user (UPN/DN); omit for Negotiate")
		p.add_argument("--password", default="", help="Simple bind password")

	@staticmethod
	def build_remote_args(ns) -> List[str]:
		dc       = getattr(ns, "dc", "") or ""
		if dc and _is_ip(dc):
			raise ValueError("--dc must be a hostname/FQDN, not an IP address")

		use_ldaps = 1 if getattr(ns, "ldaps", False) else 0
		port_in   = int(getattr(ns, "port", 0) or 0)
		# Default ports by scheme if not provided
		port      = port_in if port_in > 0 else (636 if use_ldaps else 389)

		base_dn   = getattr(ns, "basedn", "") or ""
		filt      = getattr(ns, "filter", "") or ""
		usersOnly = 1 if getattr(ns, "users", False) else 0
		attrsCSV  = getattr(ns, "attributes", "") or ""
		bindUser  = getattr(ns, "user", "") or ""
		bindPass  = getattr(ns, "password", "") or ""

		# Pack in exact BOF order/types:
		# 1 -Z dcHostW, 2 -i useLdaps, 3 -i port,
		# 4 -Z baseDN,  5 -Z filter,   6 -i usersOnly,
		# 7 -Z attrs,   8 -Z bindUser, 9 -Z bindPass
		return [
			f"-Z:{dc}",
			f"-i:{use_ldaps}",
			f"-i:{port}",
			f"-Z:{base_dn}",
			f"-Z:{filt}",
			f"-i:{usersOnly}",
			f"-Z:{attrsCSV}",
			f"-Z:{bindUser}",
			f"-Z:{bindPass}",
		]